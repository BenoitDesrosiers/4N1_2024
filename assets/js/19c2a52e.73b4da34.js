"use strict";(self.webpackChunknotes_de_cours_4_n_1_2024=self.webpackChunknotes_de_cours_4_n_1_2024||[]).push([[6092],{5371:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>a,toc:()=>o});var s=r(5893),i=r(1151);const t={sidebar_position:2},l="Introduction \xe0 SQL Server",a={id:"R\xe9vision SQL/introduction_SQL_Server",title:"Introduction \xe0 SQL Server",description:"Microsoft SQL Server est un syst\xe8me de gestion de base de donn\xe9es relationnelle cr\xe9\xe9 par Microsoft. Son utilisation est tr\xe8s similaire aux autres SGBDR.",source:"@site/docs/10-R\xe9vision SQL/introduction_SQL_Server.md",sourceDirName:"10-R\xe9vision SQL",slug:"/R\xe9vision SQL/introduction_SQL_Server",permalink:"/4N1_2024/docs/R\xe9vision SQL/introduction_SQL_Server",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"NotesSidebar",previous:{title:"Exercices",permalink:"/4N1_2024/docs/Intro Csharp/exercices_c_sharp"},next:{title:"Exercices de cr\xe9ation BD - Univers",permalink:"/4N1_2024/docs/R\xe9vision SQL/exercice_revision_sql"}},d={},o=[{value:"Table",id:"table",level:2},{value:"Colonne",id:"colonne",level:2},{value:"Vue",id:"vue",level:2},{value:"Cl\xe9 primaire",id:"cl\xe9-primaire",level:2},{value:"Type de donn\xe9es",id:"type-de-donn\xe9es",level:2},{value:"Entier",id:"entier",level:3},{value:"Chaine de caract\xe8res",id:"chaine-de-caract\xe8res",level:3},{value:"Date et temps",id:"date-et-temps",level:3},{value:"Nombre num\xe9rique avec pr\xe9cision",id:"nombre-num\xe9rique-avec-pr\xe9cision",level:3},{value:"Commandes de base",id:"commandes-de-base",level:2},{value:"CREATE DATABASE",id:"create-database",level:3},{value:"DROP DATABASE",id:"drop-database",level:3},{value:"USE",id:"use",level:3},{value:"CREATE TABLE",id:"create-table",level:3},{value:"DROP TABLE",id:"drop-table",level:3},{value:"NOT NULL et NULL",id:"not-null-et-null",level:3},{value:"IDENTITY",id:"identity",level:3},{value:"Concat\xe9nation de string  +",id:"concat\xe9nation-de-string--",level:3},{value:"Commentaires",id:"commentaires",level:3},{value:"Contraintes",id:"contraintes",level:2},{value:"Cl\xe9 primaire",id:"cl\xe9-primaire-1",level:3},{value:"Cl\xe9 \xe9trang\xe8re",id:"cl\xe9-\xe9trang\xe8re",level:3},{value:"Table pivot - Cl\xe9 primaire compos\xe9e avec cl\xe9 \xe9trang\xe8re",id:"table-pivot---cl\xe9-primaire-compos\xe9e-avec-cl\xe9-\xe9trang\xe8re",level:3},{value:"Contrainte de v\xe9rification",id:"contrainte-de-v\xe9rification",level:3},{value:"Valeur par d\xe9faut",id:"valeur-par-d\xe9faut",level:3},{value:"Contrainte d&#39;unicit\xe9",id:"contrainte-dunicit\xe9",level:3},{value:"ALTER TABLE",id:"alter-table",level:2},{value:"Cl\xe9 \xe9trang\xe8re",id:"cl\xe9-\xe9trang\xe8re-1",level:3},{value:"Contrainte de v\xe9rification",id:"contrainte-de-v\xe9rification-1",level:3},{value:"T-SQL",id:"t-sql",level:2},{value:"DB_ID()",id:"db_id",level:3},{value:"OBJECT_ID()",id:"object_id",level:3},{value:"GO",id:"go",level:2},{value:"sp_help",id:"sp_help",level:2},{value:"Variable",id:"variable",level:2},{value:"Exemple de script complexe",id:"exemple-de-script-complexe",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"introduction-\xe0-sql-server",children:"Introduction \xe0 SQL Server"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Microsoft SQL Server"})," est un syst\xe8me de gestion de base de donn\xe9es relationnelle cr\xe9\xe9 par ",(0,s.jsx)(n.strong,{children:"Microsoft"}),". Son utilisation est tr\xe8s similaire aux autres ",(0,s.jsx)(n.strong,{children:"SGBDR"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["La plupart des commandes pr\xe9sent\xe9es lors du cours de base de donn\xe9es ",(0,s.jsx)(n.strong,{children:"420-3N3-DM"})," sont fonctionnelles."]}),"\n",(0,s.jsx)(n.p,{children:"Ce document pr\xe9sentera certaines diff\xe9rences par rapport \xe0 la BD utilis\xe9e pr\xe9c\xe9demment et les nouvelles notions \xe0 apprendre."}),"\n",(0,s.jsx)(n.h1,{id:"nomenclature",children:"Nomenclature"}),"\n",(0,s.jsx)(n.p,{children:"Chaque cours utilise sa propre nomenclature. Il sera important de respecter la nomenclature de ce cours."}),"\n",(0,s.jsx)(n.p,{children:"Chaque organisation utilise un standard dans leur nomenclature. Il existe des nomenclatures qui sont accept\xe9es par la majorit\xe9 de la communaut\xe9. Dans le cadre de ce cours, nous allons utiliser cette nomenclature."}),"\n",(0,s.jsx)(n.h2,{id:"table",children:"Table"}),"\n",(0,s.jsxs)(n.p,{children:["Pour ce cours, le nom d'une table doit \xeatre au ",(0,s.jsx)(n.strong,{children:"singulier"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Le nom doit \xeatre en ",(0,s.jsx)(n.strong,{children:"PascalCase"})]}),"\n",(0,s.jsx)(n.p,{children:"Pour les tables de relation plusieurs \xe0 plusieurs il peut avoir 2 situations."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Il n'y a pas de nom significatif, nous utilisons le nom de toutes les tables."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["La relation entre les tables ",(0,s.jsx)(n.strong,{children:"Commande"})," et ",(0,s.jsx)(n.strong,{children:"Produit"}),". La table sera ",(0,s.jsx)(n.strong,{children:"CommandeProduit"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Le concept d'unification peut avoir un nom significatif, donc on l'utilise ce nom significatif."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["La m\xeame relation entre les tables ",(0,s.jsx)(n.strong,{children:"Commande"})," et ",(0,s.jsx)(n.strong,{children:"Produit"})," pourrait s'appeler ",(0,s.jsx)(n.strong,{children:"CommandeDetail"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"colonne",children:"Colonne"}),"\n",(0,s.jsxs)(n.p,{children:["Le nom d'une colonne doit \xeatre en ",(0,s.jsx)(n.strong,{children:"PascalCase"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"vue",children:"Vue"}),"\n",(0,s.jsxs)(n.p,{children:["Les vues doivent utiliser le pr\xe9fixe ",(0,s.jsx)(n.strong,{children:"v"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Exemple ",(0,s.jsx)(n.strong,{children:"vFacturationDetail"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"cl\xe9-primaire",children:"Cl\xe9 primaire"}),"\n",(0,s.jsxs)(n.p,{children:["La cl\xe9 primaire doit avoir le nom de la table et du suffixe ",(0,s.jsx)(n.strong,{children:"Id"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL PRIMARY KEY\r\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"type-de-donn\xe9es",children:"Type de donn\xe9es"}),"\n",(0,s.jsx)(n.p,{children:"Les types de donn\xe9es utilis\xe9s par SQL Server sont similaires \xe0 MariaDB ou PostGres. Par contre. il existe quelques diff\xe9rences."}),"\n",(0,s.jsxs)(n.p,{children:["Pour acc\xe9der au document de r\xe9f\xe9rences sur le site ",(0,s.jsx)(n.strong,{children:"Learn"})," de Microsoft :"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/fr-ca/sql/t-sql/data-types/data-types-transact-sql?view=sql-server-ver15",children:"https://learn.microsoft.com/fr-ca/sql/t-sql/data-types/data-types-transact-sql?view=sql-server-ver15"})}),"\n",(0,s.jsx)(n.h3,{id:"entier",children:"Entier"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SQL Server"})," utilise 4 types de donn\xe9es pour les nombres entiers. Le plus utilis\xe9 pour les cl\xe9s primaires est le type ",(0,s.jsx)(n.strong,{children:"INT"}),"."]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Plage"}),(0,s.jsx)(n.th,{children:"Taille"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"TINYINT"}),(0,s.jsx)(n.td,{children:"0 \xe0 255"}),(0,s.jsx)(n.td,{children:"1 octet"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SMALLINT"}),(0,s.jsx)(n.td,{children:"-32 768 \xe0 32 767"}),(0,s.jsx)(n.td,{children:"2 octets"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"INT"}),(0,s.jsx)(n.td,{children:"-2 147 483 648 \xe0 2 147 483 647"}),(0,s.jsx)(n.td,{children:"4 octets"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"BIGINT"}),(0,s.jsx)(n.td,{children:"-9 223 372 036 854 775 808 \xe0 9 223 372 036 854 775 807"}),(0,s.jsx)(n.td,{children:"8 octets"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["Pour plus d'information : ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/fr-ca/sql/t-sql/data-types/int-bigint-smallint-and-tinyint-transact-sql?view=sql-server-ver15",children:"https://learn.microsoft.com/fr-ca/sql/t-sql/data-types/int-bigint-smallint-and-tinyint-transact-sql?view=sql-server-ver15"})]}),"\n",(0,s.jsx)(n.h3,{id:"chaine-de-caract\xe8res",children:"Chaine de caract\xe8res"}),"\n",(0,s.jsx)(n.p,{children:"Il existe plusieurs types de chaine de caract\xe8res."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CHAR(n)"})," et ",(0,s.jsx)(n.strong,{children:"VARCHAR(n)"}),". Le caract\xe8re est encod\xe9 en utilisant 1 octet. La valeur ",(0,s.jsx)(n.strong,{children:"n"})," d\xe9signe la longueur de la chaine de caract\xe8res (entre 1 et 8000)."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NCHAR(n)"})," et ",(0,s.jsx)(n.strong,{children:"NVARCHAR(n)"}),".  Le caract\xe8re est encod\xe9 en utilisant 2 octets (parfois 4). Le pr\xe9fixe ",(0,s.jsx)(n.strong,{children:"N"})," est pour Unicode. La valeur ",(0,s.jsx)(n.strong,{children:"n"})," d\xe9signe la longueur de la chaine de caract\xe8res (entre 1 et 4000)."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CHAR"})," et ",(0,s.jsx)(n.strong,{children:"NCHAR"})," ont une longueur fixe. Donc un ",(0,s.jsx)(n.strong,{children:"CHAR(25)"})," utilisera toujours 25 caract\xe8res en m\xe9moire."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"VARCHAR"})," et ",(0,s.jsx)(n.strong,{children:"NVARCHAR"})," ont une longueur variable. SQL Server utilisera le minimum d\u2019espace + 2 octets."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Microsoft"})," ne recommande plus l'utilisation des types ",(0,s.jsx)(n.strong,{children:"TEXT"})," et ",(0,s.jsx)(n.strong,{children:"NTEXT"}),". Pour utiliser leur \xe9quivalent, il faut utiliser un ",(0,s.jsx)(n.strong,{children:"VARCHAR(MAX)"})," ou ",(0,s.jsx)(n.strong,{children:"NVARCHAR(MAX)"}),". L'espace maximum utilisable pour le stockage des caract\xe8res sera de 2 Go."]}),"\n",(0,s.jsxs)(n.p,{children:["Pour plus d'information : ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/fr-ca/sql/t-sql/data-types/char-and-varchar-transact-sql?view=sql-server-ver15",children:"https://learn.microsoft.com/fr-ca/sql/t-sql/data-types/char-and-varchar-transact-sql?view=sql-server-ver15"})]}),"\n",(0,s.jsx)(n.h3,{id:"date-et-temps",children:"Date et temps"}),"\n",(0,s.jsxs)(n.p,{children:["Le format ",(0,s.jsx)(n.strong,{children:"DATETIME"})," est le plus populaire, car il \xe9tait le type de base avant 2008 avec le ",(0,s.jsx)(n.strong,{children:"SMALLDATETIME"}),". Par la suite, il y a eu d'autres types pour g\xe9rer les dates et le temps."]}),"\n",(0,s.jsxs)(n.p,{children:["Le format ",(0,s.jsx)(n.strong,{children:"DATETIME"})," et ",(0,s.jsx)(n.strong,{children:"SMALLDATETIME"})," contiennent la date et l'heure. Ce type devrait uniquement utiliser lorsque les 2 concepts doivent \xeatre regroup\xe9s ensemble, comme pour la cr\xe9ation d'un \xe9l\xe9ment."]}),"\n",(0,s.jsxs)(n.p,{children:["Le ",(0,s.jsx)(n.strong,{children:"DATETIME"})," peut avoir des valeurs entre 1753-01-01 \xe0 9999-12-31 et a une pr\xe9cision de 0,00333 seconde."]}),"\n",(0,s.jsxs)(n.p,{children:["Le ",(0,s.jsx)(n.strong,{children:"SMALLDATETIME"})," peut avoir des valeurs entre 1900-01-01 \xe0 2079-06-06 et \xe0 une pr\xe9cision \xe0 la minute."]}),"\n",(0,s.jsxs)(n.p,{children:["Le ",(0,s.jsx)(n.strong,{children:"DATETIME2"})," peut avoir des valeurs entre 0001-01-01 \xe0 9999-12-31 et \xe0 une pr\xe9cision \xe0 la minute. Il a comme pr\xe9cision jusqu'\xe0 100 nanosecondes."]}),"\n",(0,s.jsxs)(n.p,{children:["Le format ",(0,s.jsx)(n.strong,{children:"DATE"})," contient uniquement la date. Il peut contenir des dates entre 0001-01-01 et 9999-12-31."]}),"\n",(0,s.jsxs)(n.p,{children:["Le format ",(0,s.jsx)(n.strong,{children:"TIME"})," contient uniquement l'heure. Il a comme pr\xe9cision jusqu'\xe0 100 nanosecondes. Il peut contenir l'heure entre 00:00:00.0000000 et 23:59:59.9999999."]}),"\n",(0,s.jsxs)(n.p,{children:["Le ",(0,s.jsx)(n.strong,{children:"DATETIMEOFFSET"})," est comme le ",(0,s.jsx)(n.strong,{children:"DATETIME2"}),", mais il inclut l'information du fuseau horaire en UTC."]}),"\n",(0,s.jsx)(n.p,{children:"Plus le type est pr\xe9cis ou contient une plage plus vari\xe9e, il demande plus d'espace dans la base de donn\xe9es."}),"\n",(0,s.jsxs)(n.p,{children:["Pour plus d'information : ",(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/fr-ca/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql?redirectedfrom=MSDN&view=sql-server-ver15",children:"https://docs.microsoft.com/fr-ca/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql?redirectedfrom=MSDN&view=sql-server-ver15"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SQL Server"})," n'offre pas directement des champs de type ",(0,s.jsx)(n.strong,{children:"TIMESTAMP"})," pour enregistrer des moments sur des actions de la table. Il est possible de simuler le comportement similaire \xe0 MariaDB pour la modification avec des ",(0,s.jsx)(n.strong,{children:"triggers"}),". L'approche ",(0,s.jsx)(n.strong,{children:"MariaDB"})," est plus conviviale. Dans ce cours, ce comportement sera g\xe9r\xe9 avec ",(0,s.jsx)(n.strong,{children:"Entity Framework"})," et non en pur ",(0,s.jsx)(n.strong,{children:"SQL"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"nombre-num\xe9rique-avec-pr\xe9cision",children:"Nombre num\xe9rique avec pr\xe9cision"}),"\n",(0,s.jsxs)(n.p,{children:["Le type ",(0,s.jsx)(n.strong,{children:"DECIMAL"})," permet d'enregistrer avec pr\xe9cision un chiffre avec une virgule."]}),"\n",(0,s.jsx)(n.p,{children:"Sa syntaxe de d\xe9claration est particuli\xe8re, car il faut indiquer sa longueur et sa pr\xe9cision."}),"\n",(0,s.jsxs)(n.p,{children:["Par exemple ",(0,s.jsx)(n.strong,{children:"DECIMAL(4,2)"})," indique qu'il peut avoir 4 chiffres au total avec 2 d\xe9cimales. Donc, il peut contenir une valeur entre -99,99 et 99,99."]}),"\n",(0,s.jsxs)(n.p,{children:["Si nous ajoutons une plus grande pr\xe9cision lors de l'insertion, exemple ",(0,s.jsx)(n.strong,{children:"99.986"}),", SQL Server fera un arrondi, donc ",(0,s.jsx)(n.strong,{children:"99.99"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Et ",(0,s.jsx)(n.strong,{children:"99.085"})," retournera ",(0,s.jsx)(n.strong,{children:"99.08"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Essayez pour la valeur ",(0,s.jsx)(n.strong,{children:"99.996"}),". Le syst\xe8me vous retourne une erreur, car l'arrondi correspond \xe0 ",(0,s.jsx)(n.strong,{children:"100.00"})," et la valeur n'est plus dans la plage permise."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE TestDecimal\r\n(\r\n\tValeur DECIMAL(4,2)\r\n);\r\n\r\nINSERT INTO TestDecimal(Valeur) VALUES (99.986); -- Valeur enregistr\xe9e : 99.99\r\n\r\nINSERT INTO TestDecimal(Valeur) VALUES (99.996) -- Erreur, car SQL essaie d'enregistrer 100.00\n"})}),"\n",(0,s.jsx)(n.h2,{id:"commandes-de-base",children:"Commandes de base"}),"\n",(0,s.jsx)(n.h3,{id:"create-database",children:"CREATE DATABASE"}),"\n",(0,s.jsx)(n.p,{children:"Voici la syntaxe de cr\xe9ation d'une base de donn\xe9es."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE DATABASE Demo4N1;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"drop-database",children:"DROP DATABASE"}),"\n",(0,s.jsx)(n.p,{children:"Voici la syntaxe de destruction d'une base de donn\xe9es."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DROP DATABASE Demo4N1;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"use",children:"USE"}),"\n",(0,s.jsxs)(n.p,{children:["La commande ",(0,s.jsx)(n.strong,{children:"USE"})," permet de s\xe9lectionner une base de donn\xe9es par programmation. Donc, si vous \xeates dans une autre base de donn\xe9es dans la barre d'outils, il est possible de changer la base de donn\xe9es au pr\xe9alable dans votre script."]}),"\n",(0,s.jsxs)(n.p,{children:["La majorit\xe9 des scripts d\xe9bute par le ",(0,s.jsx)(n.strong,{children:"USE"})," pour s'assurer que l'ex\xe9cution se fait au bon endroit."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"USE Demo4N1;\r\nGO\n"})}),"\n",(0,s.jsx)(n.h3,{id:"create-table",children:"CREATE TABLE"}),"\n",(0,s.jsx)(n.p,{children:"Voici la syntaxe pour la cr\xe9ation d'une table."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE MaTable\r\n(\r\n\tMaTableId INT NOT NULL PRIMARY KEY IDENTITY,\r\n\tDescription VARCHAR(30) NOT NULL,\r\n    Detail VARCHAR(500) NOT NULL,\r\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"drop-table",children:"DROP TABLE"}),"\n",(0,s.jsx)(n.p,{children:"Voici la syntaxe pour la destruction d'une table."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DROP TABLE MaTable;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"not-null-et-null",children:"NOT NULL et NULL"}),"\n",(0,s.jsxs)(n.p,{children:["Par d\xe9faut, si aucune sp\xe9cification n'est indiqu\xe9e, le champ sera consid\xe9r\xe9 comme optionnel ou pouvant contenir la valeur ",(0,s.jsx)(n.strong,{children:"NULL"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Pour s'assurer qu'une valeur soit entrer dans une colonne, il faut indiquer ",(0,s.jsx)(n.strong,{children:"NOT NULL"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE MaTable\r\n(\r\n\tMaTableId INT NOT NULL PRIMARY KEY IDENTITY, --Champ obligatoire\r\n\tDescription VARCHAR(30) NULL, --Champ optionnel\r\n\tDetail VARCHAR(500), --Champ optionnel\r\n);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Par convention, il est pr\xe9f\xe9rable d'\xeatre constant pour la d\xe9claration des champs optionnels."}),"\n",(0,s.jsx)(n.h3,{id:"identity",children:"IDENTITY"}),"\n",(0,s.jsxs)(n.p,{children:["Pour avoir un identifiant qui s'autoincr\xe9mente, il faut lui donner l'attribut ",(0,s.jsx)(n.strong,{children:"IDENTITY"})]}),"\n",(0,s.jsx)(n.p,{children:"Voici un script de cr\xe9ation d'une table."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL PRIMARY KEY IDENTITY,\r\n\tNom VARCHAR(100) NOT NULL\r\n);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["La cl\xe9 primaire a le mot cl\xe9 ",(0,s.jsx)(n.strong,{children:"IDENTITY"})," qui indique que la cl\xe9 de la table sera auto incr\xe9ment\xe9e. Il s'agit donc d'une cl\xe9 artificielle."]}),"\n",(0,s.jsx)(n.p,{children:"Par d\xe9faut, l'incr\xe9mentation d\xe9bute \xe0 1 et augmente de 1."}),"\n",(0,s.jsx)(n.p,{children:"Il est possible de modifier la valeur de d\xe9part et l'augmentation par cette syntaxe."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"IDENTITY(d\xe9part, incr\xe9ment)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Donc pour la table ci-dessous, la cl\xe9 d\xe9butera \xe0 1000 et la suivante sera 1005"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL PRIMARY KEY IDENTITY(1000,5),\r\n\tNom VARCHAR(100) NOT NULL\r\n);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["La propri\xe9t\xe9 ",(0,s.jsx)(n.strong,{children:"IDENTITY"})," est g\xe9n\xe9ralement utilis\xe9e avec une cl\xe9 primaire, mais elle peut \xeatre utilis\xe9e pour un champ qui n'est pas une cl\xe9. Il est important de ne pas oublier la contrainte de cl\xe9 primaire. Par contre, il peut avoir uniquement un champ ",(0,s.jsx)(n.strong,{children:"IDENTITY"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"concat\xe9nation-de-string--",children:"Concat\xe9nation de string  +"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SQL Server"})," utilise le symbole ",(0,s.jsx)(n.strong,{children:"+"})," pour faire la concat\xe9nation de chaine de caract\xe8res."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT \r\n\tDescription + ': ' + Detail\r\nFROM MaTable;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"commentaires",children:"Commentaires"}),"\n",(0,s.jsxs)(n.p,{children:["Le ",(0,s.jsx)(n.strong,{children:"--"})," est pour une seule ligne."]}),"\n",(0,s.jsxs)(n.p,{children:["Le ",(0,s.jsx)(n.strong,{children:"/"}),"* et *",(0,s.jsx)(n.strong,{children:"/"})," est pour un bloc de commentaires."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"--Mon commentaire sur une seule ligne\r\n\r\n/*\r\nUn bloc de commentaire\r\n2e ligne...\r\n*/\n"})}),"\n",(0,s.jsx)(n.h2,{id:"contraintes",children:"Contraintes"}),"\n",(0,s.jsxs)(n.p,{children:["Pour faciliter la gestion, il est fortement recommand\xe9 de nommer les contraintes en ",(0,s.jsx)(n.strong,{children:"SQL Server"}),". Il est possible de modifier le comportement d'une contrainte sans recr\xe9er une table en utilisant son nom."]}),"\n",(0,s.jsxs)(n.p,{children:["Si aucun nom n'est sp\xe9cifi\xe9, ",(0,s.jsx)(n.strong,{children:"SQL Server"})," g\xe9n\xe8re automatiquement un nom, mais il n'aura aucune signification."]}),"\n",(0,s.jsx)(n.h3,{id:"cl\xe9-primaire-1",children:"Cl\xe9 primaire"}),"\n",(0,s.jsxs)(n.p,{children:["Le nom de la contrainte doit utiliser le pr\xe9fixe ",(0,s.jsx)(n.strong,{children:"PK_"})," et le nom de la table."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"PK_Table"})}),"\n",(0,s.jsx)(n.p,{children:"Voici un exemple."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL CONSTRAINT PK_Client PRIMARY KEY IDENTITY\r\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cl\xe9-\xe9trang\xe8re",children:"Cl\xe9 \xe9trang\xe8re"}),"\n",(0,s.jsx)(n.p,{children:"Le champ de la cl\xe9 \xe9trang\xe8re doit avoir le m\xeame nom que celle utilis\xe9e dans la table parent."}),"\n",(0,s.jsxs)(n.p,{children:["Le nom de la contrainte doit utiliser le pr\xe9fixe ",(0,s.jsx)(n.strong,{children:"FK_"}),", le nom de la table,  une barre, le nom du champ."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"FK_TableEnfant_Champ"})}),"\n",(0,s.jsx)(n.p,{children:"Ici, le client appartient \xe0 une compagnie."}),"\n",(0,s.jsxs)(n.p,{children:["Avec ",(0,s.jsx)(n.strong,{children:"SQL Server"}),", il est possible de mettre la contrainte directement sur la d\xe9claration de la colonne."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL CONSTRAINT PK_Client PRIMARY KEY,\r\n\tCompagnieId INT NOT NULL \r\n    \tCONSTRAINT FK_Client_CompagnieId FOREIGN KEY REFERENCES Compagnie(CompagnieId)\r\n    \t\tON DELETE NO ACTION\t\r\n    \t\tON UPDATE CASCADE,\r\n    EstValide BIT NOT NULL\r\n);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Il est \xe9galement possible de faire la d\xe9claration en fin de table."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL CONSTRAINT PK_Client PRIMARY KEY,\r\n\tCompagnieId INT NOT NULL,     \t\r\n    EstValide BIT NOT NULL,\r\n    CONSTRAINT FK_Client_CompagnieId FOREIGN KEY(CompagnieId) REFERENCES Compagnie(CompagnieId)\r\n    \tON DELETE NO ACTION \r\n    \tON UPDATE CASCADE\r\n);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Le comportement des actions par d\xe9faut est ",(0,s.jsx)(n.strong,{children:"NO ACTION"})," s'il n'est pas sp\xe9cifi\xe9."]}),"\n",(0,s.jsx)(n.h3,{id:"table-pivot---cl\xe9-primaire-compos\xe9e-avec-cl\xe9-\xe9trang\xe8re",children:"Table pivot - Cl\xe9 primaire compos\xe9e avec cl\xe9 \xe9trang\xe8re"}),"\n",(0,s.jsx)(n.p,{children:"Lorsqu'on a une relation n-m il faut utiliser une table pivot qui entreposera la cl\xe9 des 2 tables."}),"\n",(0,s.jsx)(n.p,{children:"Par exemple, si nous avons un table contenant les produits, et une contenant les commandes, il est possible d'avoir plusieurs produits sur une commande et qu'un produit se retrouve sur plusieurs commandes."}),"\n",(0,s.jsx)(n.p,{children:"L'approche recommand\xe9e pour la table pivot est celle-ci :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE CommandeProduit\r\n(\r\n\tCommandeId INT NOT NULL CONSTRAINT FK_CommandeProduit_CommandeId \r\n\t\tFOREIGN KEY REFERENCES Commande(CommandeId),\r\n    \t\tON DELETE NO ACTION\t\r\n    \t\tON UPDATE CASCADE\r\n\tProduitId INT NOT NULL CONSTRAINT FK_CommandeProduit_ProduitId FOREIGN \r\n\t\tKEY REFERENCES Produit(ProduitId),\r\n       \t\tON DELETE NO ACTION\t\r\n    \t\tON UPDATE CASCADE\r\n\t--highlight-next-line\r\n    CONSTRAINT PK_CommandeProduit PRIMARY KEY(ComandeId, ProduitId)\r\n);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Notez la contrainte de cl\xe9 primaire \xe0 la fin."}),"\n",(0,s.jsx)(n.h3,{id:"contrainte-de-v\xe9rification",children:"Contrainte de v\xe9rification"}),"\n",(0,s.jsxs)(n.p,{children:["La contrainte de v\xe9rification est d'accepter uniquement des valeurs pr\xe9cises pour une colonne. Il s'agit d'un ",(0,s.jsx)(n.strong,{children:"CHECK"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Le nom de la contrainte doit utiliser le pr\xe9fixe ",(0,s.jsx)(n.strong,{children:"CK_"})," , le nom de la table, une barre et le nom du champ."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CK_Table_Champ"})}),"\n",(0,s.jsx)(n.p,{children:"Voici un exemple."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL CONSTRAINT PK_Client PRIMARY KEY,\r\n\tCompagnieId INT NOT NULL CONSTRAINT FK_Client_CompagnieId FOREIGN KEY REFERENCES Compagnie(CompagnieId)\r\n    \tON DELETE NO ACTION\t\r\n    \tON UPDATE CASCADE,\r\n\t\t\t--highlight-next-line\r\n\tType CHAR(1) NOT NULL CONSTRAINT CK_Client_Type CHECK(Type IN ('A', 'D', 'X'))\r\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"valeur-par-d\xe9faut",children:"Valeur par d\xe9faut"}),"\n",(0,s.jsxs)(n.p,{children:["Le nom de la contrainte doit utiliser le pr\xe9fixe ",(0,s.jsx)(n.strong,{children:"DF_"}),",  le nom de la table, une barre et le nom du champ."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"DF_Table_Champ"})}),"\n",(0,s.jsx)(n.p,{children:"Voici un exemple."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL CONSTRAINT PK_Client PRIMARY KEY,\r\n\tCompagnieId INT NOT NULL CONSTRAINT FK_Client_CompagnieId FOREIGN KEY REFERENCES Compagnie(CompagnieId)\r\n    \tON DELETE NO ACTION\t\r\n    \tON UPDATE CASCADE,\r\n\t\t\t--highlight-next-line\r\n\tDateCreation DATETIME NOT NULL CONSTRAINT DF_Client_DateCreation DEFAULT GetDate(),\r\n\t\t--highlight-next-line\r\n\tEstActif BIT NOT NULL CONSTRAINT DF_Client_EstActif DEFAULT 1\r\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"contrainte-dunicit\xe9",children:"Contrainte d'unicit\xe9"}),"\n",(0,s.jsxs)(n.p,{children:["Le nom de la contrainte doit utiliser le pr\xe9fixe ",(0,s.jsx)(n.strong,{children:"UQ_"}),",  le nom de la table, une barre et le nom du champ."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"UQ_Table_Champ"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL CONSTRAINT PK_Client PRIMARY KEY,\r\n\tCompagnieId INT NOT NULL CONSTRAINT FK_Client_CompagnieId FOREIGN KEY REFERENCES Compagnie(CompagnieId)\r\n    \tON DELETE NO ACTION\t\r\n    \tON UPDATE CASCADE,\r\n\tType VARCHAR(1) CONSTRAINT CK_Client_Type CHECK(Type IN ('A', 'D', 'X')),\r\n\tActif BIT NOT NULL CONSTRAINT DF_Client_Actif DEFAULT 1,\r\n\t\t--highlight-next-line\r\n\tCode VARCHAR(10) NOT NULL CONSTRAINT UQ_Client_Code UNIQUE\r\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"alter-table",children:"ALTER TABLE"}),"\n",(0,s.jsxs)(n.p,{children:["Il est possible de modifier une table une fois qu'elle a \xe9t\xe9 cr\xe9\xe9e. Pour ce faire, on utilise la commande ",(0,s.jsx)(n.strong,{children:"ALTER TABLE"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["On ne peut pas directement modifier une contrainte, il faut premi\xe8rement l'enlever \xe0 l'aide de ",(0,s.jsx)(n.strong,{children:"DROP CONSTRAINT"})," , et ensuite ajouter la contrainte red\xe9finie \xe0 l'aide de ",(0,s.jsx)(n.strong,{children:"ADD CONSTRAINT"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Pour les tables ci-dessous, voici quelques exemples de modification."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Compagnie\r\n(\r\n\tCompagnieId INT NOT NULL CONSTRAINT PK_Compagnie PRIMARY KEY IDENTITY,\r\n\tNom VARCHAR(50) NOT NULL\r\n);\r\n\r\nCREATE TABLE Client\r\n(\r\n\tClientId INT NOT NULL CONSTRAINT PK_Client PRIMARY KEY,\r\n\tCompagnieId INT NOT NULL CONSTRAINT FK_Client_CompagnieId FOREIGN KEY REFERENCES Compagnie(CompagnieId)\r\n    \tON DELETE NO ACTION\t\r\n    \tON UPDATE CASCADE,\r\n\tType VARCHAR(1) CONSTRAINT CK_Client_Type CHECK(Type IN ('A', 'D', 'X')),\r\n\tActif BIT NOT NULL CONSTRAINT DF_Client_Actif DEFAULT 1,\r\n\tCode VARCHAR(10) NOT NULL CONSTRAINT UQ_Client_Code UNIQUE\r\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cl\xe9-\xe9trang\xe8re-1",children:"Cl\xe9 \xe9trang\xe8re"}),"\n",(0,s.jsx)(n.p,{children:"Pour modifier les actions d'une cl\xe9 \xe9trang\xe8re il faut commencer par l'enlever et ensuite en cr\xe9er une nouvelle selon nos besoin"}),"\n",(0,s.jsxs)(n.p,{children:["Ici on change ",(0,s.jsx)(n.strong,{children:"ON DELETE NO ACTION ON UPDATE CASCADE"})," par  ",(0,s.jsx)(n.strong,{children:"ON DELETE CASCADE ON UPDATE CASCADE"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE Client\r\nDROP CONSTRAINT FK_Client_CompagnieId;\r\n\r\nALTER TABLE Client\r\nADD CONSTRAINT FK_Client_CompagnieId FOREIGN KEY(CompagnieId) REFERENCES Compagnie(CompagnieId) \r\n\tON DELETE CASCADE ON UPDATE CASCADE;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"contrainte-de-v\xe9rification-1",children:"Contrainte de v\xe9rification"}),"\n",(0,s.jsx)(n.p,{children:"Pour ajouter une contrainte, il faut commencer par l'enlever et ensuite en cr\xe9er une nouvelle selon nos besoins."}),"\n",(0,s.jsxs)(n.p,{children:["Ici on ajoute ",(0,s.jsx)(n.strong,{children:"Z"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE Client\r\nDROP CONSTRAINT CK_Client_Type;\r\n\r\nALTER TABLE Client\r\nADD CONSTRAINT CK_Client_Type CHECK(Type IN ('A', 'D', 'X', 'Z'));\n"})}),"\n",(0,s.jsx)(n.h2,{id:"t-sql",children:"T-SQL"}),"\n",(0,s.jsxs)(n.p,{children:["Le langage de requ\xeates pour acc\xe9der \xe0 ",(0,s.jsx)(n.strong,{children:"SQL Server"})," s\u2019appelle ",(0,s.jsx)(n.strong,{children:"T-SQL"}),", ou encore ",(0,s.jsx)(n.strong,{children:"Transact-SQL"}),". ",(0,s.jsx)(n.strong,{children:"T-SQL"})," est une extension du langage SQL."]}),"\n",(0,s.jsx)(n.p,{children:"C'est-\xe0-dire que les commandes SQL sont pratiquement identiques, mais il y a des ajouts pour faire de la programmation proc\xe9durale."}),"\n",(0,s.jsxs)(n.p,{children:["Comme pour le SQL, le ",(0,s.jsx)(n.strong,{children:"T-SQL"})," n'est pas sensible \xe0 la casse."]}),"\n",(0,s.jsxs)(n.p,{children:["Pour plus d'information : ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Transact-SQL",children:"https://en.wikipedia.org/wiki/Transact-SQL"})]}),"\n",(0,s.jsx)(n.h3,{id:"db_id",children:"DB_ID()"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SQL Server"})," n'utilise pas le ",(0,s.jsx)(n.strong,{children:"IF EXISTS"})," et le ",(0,s.jsx)(n.strong,{children:"IF NOT EXISTS"})," comme avec ",(0,s.jsx)(n.strong,{children:"SQLite"})," et ",(0,s.jsx)(n.strong,{children:"MariaDB"}),"."]})}),"\n",(0,s.jsxs)(n.p,{children:["Pour v\xe9rifier l'existence d'une base de donn\xe9es, il faut utiliser la fonction ",(0,s.jsx)(n.strong,{children:"DB_ID(nombd)"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"--V\xe9rifie si la base de donn\xe9es est inexistante dans le SGBD\r\nIF DB_ID('Demo4N1') IS NULL \r\n\tCREATE DATABASE Demo4N1;\r\n\r\n--V\xe9rifie si la base de donn\xe9es existe dans le SGBD\r\nIF DB_ID('Demo4N1') IS NOT NULL \r\n\tDROP DATABASE Demo4N1;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"object_id",children:"OBJECT_ID()"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SQL Server"})," n'utilise pas le ",(0,s.jsx)(n.strong,{children:"IF EXISTS"})," et le ",(0,s.jsx)(n.strong,{children:"IF NOT EXISTS"})," comme avec ",(0,s.jsx)(n.strong,{children:"SQLite"})," et ",(0,s.jsx)(n.strong,{children:"MariaDB"}),"."]})}),"\n",(0,s.jsxs)(n.p,{children:["Il faut utiliser la fonction ",(0,s.jsx)(n.strong,{children:"OBJECT_ID(nom, type)"})," pour d\xe9terminer l'existence ou non d'un \xe9l\xe9ment dans une base de donn\xe9es. Il faut sp\xe9cifier le nom de l'\xe9l\xe9ment et ensuite son type."]}),"\n",(0,s.jsx)(n.p,{children:"Voici la liste des types."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"AF"})," = Fonction d'agr\xe9gation (CLR)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"C"})," = contrainte CHECK"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"D"})," = DEFAULT (contrainte ou autonome)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"F"})," = Contrainte FOREIGN KEY"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"FN"})," = Fonction scalaire SQL"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"FS"})," = Fonction scalaire d'assembly (CLR)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"FT"})," = Fonction table d'assembly (CLR)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IF"})," = Fonction table en ligne SQL"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IT"})," = Table interne"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"P"})," = Proc\xe9dure stock\xe9e SQL"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PC"})," = Assembly (CLR) proc\xe9dure stock\xe9e"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PG"})," = Rep\xe8re de plan"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PK"})," = Contrainte PRIMARY KEY"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"R"})," = R\xe8gle (ancienne, autonome)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"RF"})," = Proc\xe9dure de filtre de r\xe9plication"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"S"})," = Table de base syst\xe8me"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SN"})," = Synonyme"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SO"})," = Objet s\xe9quence"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"U"})," = Table (d\xe9finie par l'utilisateur)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"V"})," = Vue"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Pour les tables, il faut utiliser le type ",(0,s.jsx)(n.strong,{children:"U"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"--V\xe9rifie si la table est inexistante dans la base de donn\xe9es \r\n--Le type U est pour User Table\r\nIF OBJECT_ID('Matable', 'U') IS NULL \r\n\tCREATE TABLE MaTable\r\n\t(\r\n\t\tMaTableId INT NOT NULL PRIMARY KEY IDENTITY,\r\n\t\tDescription VARCHAR(30) NOT NULL,\r\n\t\tDetail VARCHAR(500) NOT NULL,\r\n\t);\r\n\t\r\n--V\xe9rifie si la table existe dans la base de donn\xe9es\r\nIF OBJECT_ID('Matable', 'U') IS NOT NULL \r\n\tDROP TABLE MaTable;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"go",children:"GO"}),"\n",(0,s.jsxs)(n.p,{children:["La commande ",(0,s.jsx)(n.strong,{children:"GO"})," permet d'ex\xe9cuter tout le code au-dessus en lot."]}),"\n",(0,s.jsxs)(n.p,{children:["Lorsqu'on veut s\xe9parer un script en plusieurs lots d'ex\xe9cution, on met un ",(0,s.jsx)(n.strong,{children:"GO"})," apr\xe8s chacune des sections."]}),"\n",(0,s.jsxs)(n.p,{children:["Certaines commandes, comme un ",(0,s.jsx)(n.strong,{children:"CREATE VIEW"})," doit \xeatre obligatoirement en d\xe9but de lot."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Produit\r\n(\r\n\tProduitId INT NOT NULL PRIMARY KEY IDENTITY,\r\n\tNom VARCHAR(500) NOT NULL\r\n);\r\n\r\nCREATE VIEW ListeProduit \r\nAS\r\nSELECT * FROM Produit;\r\n\r\n--Message d'erreur\r\n--Msg\xa0111, Niveau\xa015, \xc9tat\xa01, Ligne\xa08\r\n--'CREATE VIEW' must be the first statement in a query batch.\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Malgr\xe9 l'erreur, la table ",(0,s.jsx)(n.strong,{children:"Produit"})," a \xe9t\xe9 cr\xe9\xe9e. L'erreur s'applique uniquement \xe0 la vue."]}),"\n",(0,s.jsxs)(n.p,{children:["Il n'est pas possible d'inverser les commandes, car il faut que la table existe pour cr\xe9er la vue. L'utilisation du ",(0,s.jsx)(n.strong,{children:"GO"})," permet de corriger le probl\xe8me."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Produit\r\n(\r\n\tProduitId INT NOT NULL PRIMARY KEY IDENTITY,\r\n\tNom VARCHAR(500) NOT NULL\r\n);\r\nGO\r\nCREATE VIEW ListeProduit \r\nAS\r\nSELECT * FROM Produit;\r\nGO\n"})}),"\n",(0,s.jsx)(n.h2,{id:"sp_help",children:"sp_help"}),"\n",(0,s.jsxs)(n.p,{children:["La commande ",(0,s.jsx)(n.strong,{children:"sp_help"})," permet de g\xe9n\xe9rer un rapport d\xe9taill\xe9 sur un objet de la base de donn\xe9es. C'est tr\xe8s pratique pour avoir le d\xe9tail d'une table par exemple. Il est possible d'avoir cette information en utilisant l'explorateur d'objets."]}),"\n",(0,s.jsxs)(n.p,{children:["La syntaxe est ",(0,s.jsx)(n.strong,{children:"sp_help 'nom de l'objet'"})]}),"\n",(0,s.jsxs)(n.p,{children:["Pour avoir acc\xe8s \xe0 l'information de la table ",(0,s.jsx)(n.strong,{children:"Person.Person"})," dans la base de donn\xe9es ",(0,s.jsx)(n.strong,{children:"AdventureWorks"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"sp_help 'Person.Person'\n"})}),"\n",(0,s.jsx)(n.p,{children:"Voici le r\xe9sultat."}),"\n",(0,s.jsx)("img",{src:"/4N1_2024/img/sp_help_result_1.jpg",alt:"sp_help_result_1"}),"\n",(0,s.jsxs)(n.p,{children:["En s\xe9lectionnant du texte et en effectuant le raccourci ",(0,s.jsx)(n.strong,{children:"ALT+F1"}),", la commande ",(0,s.jsx)(n.strong,{children:"sp_help"})," s'effectuera sur le texte s\xe9lectionn\xe9."]}),"\n",(0,s.jsx)(n.h2,{id:"variable",children:"Variable"}),"\n",(0,s.jsx)(n.p,{children:"Il est possible d'utiliser des variables pour faire des scripts plus complexes."}),"\n",(0,s.jsxs)(n.p,{children:["Le nom de la variable d\xe9bute toujours par un ",(0,s.jsx)(n.strong,{children:"@"}),". Par convention, le nom de la variable est en ",(0,s.jsx)(n.strong,{children:"camelCase"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Il faut utiliser la clause ",(0,s.jsx)(n.strong,{children:"DECLARE @nomVar TYPE"})," pour la cr\xe9er."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DECLARE @nom VARCHAR(10); --D\xe9claration sans assignation de valeur\r\nDECLARE @prenom NVARCHAR(10) = 'Fran\xe7ois'; --D\xe9claration avec assignation de valeur\n"})}),"\n",(0,s.jsxs)(n.p,{children:["La clause ",(0,s.jsx)(n.strong,{children:"SET"})," permet d'assigner une valeur \xe0 la variable apr\xe8s sa d\xe9claration"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SET @nom = 'St-Hilaire';\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Pour afficher une variable, il faut utiliser un ",(0,s.jsx)(n.strong,{children:"SELECT"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT @da;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"exemple-de-script-complexe",children:"Exemple de script complexe"}),"\n",(0,s.jsxs)(n.p,{children:["Voici un exemple de script qui permet de cr\xe9er les utilisateurs et une base de donn\xe9es ",(0,s.jsx)(n.strong,{children:"AdventureWork2019"})," pour une liste d'\xe9tudiant."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"USE EtudiantBD2\r\nGO\r\n\r\nDECLARE @da NVARCHAR(10);\r\nDECLARE @nom NVARCHAR(50);\r\nDECLARE @traite INT;\r\nDECLARE @etudiant CURSOR;\r\nDECLARE @sqlstmt NVARCHAR(1000);\r\nDECLARE @sqlstmt_use NVARCHAR(1000);\r\n \r\nSET @etudiant = CURSOR FOR\r\n\tSELECT da,nom,traite\r\n\tFROM dbo.Etudiant WHERE Traite = 0;\r\n\r\nOPEN @etudiant\r\nFETCH NEXT\r\nFROM @etudiant INTO @da, @nom, @traite\r\n\r\nWHILE @@FETCH_STATUS = 0\r\nBEGIN\r\n  IF(@traite = 0) \r\n  BEGIN\r\n\t  print @da+'  '+ @nom\r\n\r\n\t  print 'Copie de la bd'\r\n\t  SET @sqlstmt = 'RESTORE DATABASE [e' + @da + '_AdventureWorks2019] ';\r\n\t  SET @sqlstmt = @sqlstmt + 'FROM  DISK = N''/var/opt/mssql/backups/AdventureWorks2019.bak''';\r\n\t  SET @sqlstmt = @sqlstmt + 'WITH  FILE = 1,'; \r\n\t  SET @sqlstmt = @sqlstmt + 'MOVE N''AdventureWorks2017'' TO N''/var/opt/mssql/data/e' + @da + '_AdventureWorks2019_Data.mdf'',';  \r\n\t  SET @sqlstmt = @sqlstmt + 'MOVE N''AdventureWorks2017_log'' TO N''/var/opt/mssql/data/e' + @da + '_AdventureWorks2019_Log.ldf'',';\r\n\t  SET @sqlstmt = @sqlstmt + 'NOUNLOAD,  STATS = 5';\r\n\t  print @sqlstmt;\r\n\t  exec(@sqlstmt);\r\n\r\n\t  print 'Cr\xe9ation de l''usager'\r\n\t  SET @sqlstmt_use = 'USE [e' + @da + '_AdventureWorks2019];'\r\n\r\n\t  SET @sqlstmt = @sqlstmt_use + 'CREATE LOGIN [e' + @da + '] WITH PASSWORD=N''usager@db2'' MUST_CHANGE, DEFAULT_DATABASE=[e' + @da + '_AdventureWorks2019], CHECK_EXPIRATION=ON, CHECK_POLICY=ON;'\r\n\r\n\t  SET @sqlstmt = @sqlstmt +'CREATE USER [e'+ @da +'] FOR LOGIN [e' + @da + '];'\r\n\t  SET @sqlstmt = @sqlstmt +'ALTER ROLE [db_owner] ADD MEMBER [e' + @da + '];'\r\n\r\n\t  SET @sqlstmt = @sqlstmt +'ALTER SERVER ROLE [dbcreator] ADD MEMBER [e' + @da +'];' /* l'\xe9tudiant pourra cr\xe9er des BDs.*/\r\n\t  exec(@sqlstmt);\r\n\t  \r\n\t  UPDATE Etudiant SET traite = 1 WHERE DA = @da;\r\n  END\r\n  FETCH NEXT \r\n  FROM @etudiant INTO @da, @nom, @traite\r\nEND\r\n\r\nCLOSE @etudiant\r\nDEALLOCATE @etudiant\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>a,a:()=>l});var s=r(7294);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);