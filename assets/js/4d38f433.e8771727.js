"use strict";(self.webpackChunknotes_de_cours_4_n_1_2024=self.webpackChunknotes_de_cours_4_n_1_2024||[]).push([[4488],{9434:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>t,metadata:()=>o,toc:()=>u});var s=n(5893),i=n(1151);const t={sidebar_position:420,draft:!1},a="Message d'erreur",o={id:"WPF partie 4/msg_erreur",title:"Message d'erreur",description:"Le formulaire de connexion n'affiche pas de message lorsque le compte n'est pas valide. Pour ce faire, il faut ajouter de la validation au formulaire.",source:"@site/docs/76-WPF partie 4/msg_erreur.md",sourceDirName:"76-WPF partie 4",slug:"/WPF partie 4/msg_erreur",permalink:"/4N1_2024/docs/WPF partie 4/msg_erreur",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:420,frontMatter:{sidebar_position:420,draft:!1},sidebar:"NotesSidebar",previous:{title:"Authentification",permalink:"/4N1_2024/docs/WPF partie 4/authentification"},next:{title:"Autorisation",permalink:"/4N1_2024/docs/WPF partie 4/autorisation"}},l={},u=[{value:"Modification du BaseVM",id:"modification-du-basevm",level:2},{value:"Ajout du message - ConnexionVM",id:"ajout-du-message---connexionvm",level:2},{value:"Test",id:"test",level:2}];function d(e){const r={admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h1,{id:"message-derreur",children:"Message d'erreur"}),"\n",(0,s.jsx)(r.p,{children:"Le formulaire de connexion n'affiche pas de message lorsque le compte n'est pas valide. Pour ce faire, il faut ajouter de la validation au formulaire."}),"\n",(0,s.jsxs)(r.p,{children:["Par contre, pour cette vue, ce ne sera pas un validateur qui s'occupera de la validation. Le ",(0,s.jsx)(r.strong,{children:"ViewModel"})," ajoutera un message d'erreur si l'authentification n'est pas valide."]}),"\n",(0,s.jsx)(r.admonition,{type:"tip",children:(0,s.jsx)(r.p,{children:"Il est conseill\xe9 de ne pas indiquer quel champs est en erreur. Il faut simplement indiquer que l'union de ce compte et mot de passe ne fonctionne pas. Il ne faut pas indiquer que c'est l'utilisateur qui est inexistant, ou que ce mot de passe n'est pas bon pour cet utilisateur. Il faut donner le moins d'indices possibles."})}),"\n",(0,s.jsx)(r.h2,{id:"modification-du-basevm",children:"Modification du BaseVM"}),"\n",(0,s.jsxs)(r.p,{children:["Ajoutez cette m\xe9thode dans la classe ",(0,s.jsx)(r.strong,{children:"BaseVM"}),"."]}),"\n",(0,s.jsx)(r.p,{children:"Cette m\xe9thode permet d'ajouter une erreur directement pour une propri\xe9t\xe9. La ligne 15 g\xe9n\xe8re l'\xe9v\xe9nement pour indiquer au composant qui est li\xe9 \xe0 la propri\xe9t\xe9 qu'il y a maintenant une erreur."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-csharp",metastring:"showLineNumbers",children:'/// <summary>\r\n/// Ajouter une erreur pour une propri\xe9t\xe9\r\n/// </summary>\r\n/// <param name="propriete">Nom de la propri\xe9t\xe9</param>\r\n/// <param name="erreur">Message d\'erreur</param>\r\nprotected void AjouterErreur(string propriete, string erreur)\r\n{\r\n    if (!_lstErreursParPropriete.ContainsKey(propriete))\r\n    {\r\n        _lstErreursParPropriete.Add(propriete, new List<string>());\r\n    }\r\n\r\n    _lstErreursParPropriete[propriete].Add(erreur);\r\n\r\n    OnErrorsChanged(propriete);\r\n}\n'})}),"\n",(0,s.jsx)(r.h2,{id:"ajout-du-message---connexionvm",children:"Ajout du message - ConnexionVM"}),"\n",(0,s.jsxs)(r.p,{children:["Modifiez la m\xe9thode ",(0,s.jsx)(r.strong,{children:"AuthentifierAsync()"})," par celle-ci."]}),"\n",(0,s.jsxs)(r.p,{children:["\xc0 la ligne 15, l'erreur est ajout\xe9e manuellement pour la propri\xe9t\xe9 ",(0,s.jsx)(r.strong,{children:"MotPasse"}),". L'utilisation du mot-cl\xe9 ",(0,s.jsx)(r.strong,{children:"nameof"})," permet de convertir en ",(0,s.jsx)(r.strong,{children:"string"})," le nom d'une propri\xe9t\xe9. Il serait possible de faire ",(0,s.jsx)(r.strong,{children:'AjouterErreur("MotPasse", "Erreur...")'}),", mais le compilateur ne serait pas en mesure de voir si la propri\xe9t\xe9 ",(0,s.jsx)(r.strong,{children:"MotPasse"})," existe r\xe9ellement, car c'est une ",(0,s.jsx)(r.strong,{children:"string"}),". Il pourrait donc y avoir une erreur \xe0 l'ex\xe9cution, alors qu'avec nameof, l'erreur est \xe0 la compilation."]}),"\n",(0,s.jsxs)(r.p,{children:["Le message s'affichera pour le mot de passe, m\xeame si le nom d'utilisateur est invalide, car l'erreur est assign\xe9e \xe0 la propri\xe9t\xe9 ",(0,s.jsx)(r.strong,{children:"MotPasse"}),"."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-csharp",metastring:"showLineNumbers",children:"private async Task AuthentifierAsync()\r\n{\r\n    ChampsModifiables = false;\r\n    EstEnTravail = true;\r\n    EffacerErreurs();\r\n\r\n    bool authentifier = await _authentificateur.AuthentifierUtilisateurAsync(NomUtilisateur, MotPasse);\r\n\r\n    if (authentifier == true)\r\n    {\r\n        _navigateur.Naviguer<ListeCategoriesVM>();\r\n    }\r\n    //highlight-start\r\n    else\r\n    {\r\n        AjouterErreur(nameof(MotPasse), \"La combinaison du nom d'utilisateur et du mot de passe n'est pas valide.\");\r\n    }\r\n//highlight-end\r\n\r\n    EstEnTravail = false;\r\n    ChampsModifiables = true;\r\n}\n"})}),"\n",(0,s.jsx)(r.admonition,{type:"info",children:(0,s.jsx)(r.p,{children:"Le message d'erreur n'est pas localis\xe9."})}),"\n",(0,s.jsx)(r.h2,{id:"test",children:"Test"}),"\n",(0,s.jsxs)(r.p,{children:["La vue ",(0,s.jsx)(r.strong,{children:"UcConnexion"})," a d\xe9j\xe0 le ",(0,s.jsx)(r.strong,{children:'Validation.ErrorTemplate="\r\n{StaticResource erreurTemplate}"'})," pour les composants."]}),"\n",(0,s.jsx)(r.p,{children:"Essayez avec ce compte."}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"fsthilaire"}),"\n",(0,s.jsx)(r.li,{children:"1234"}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Le message d'erreur s'affiche."}),"\n",(0,s.jsx)(r.p,{children:"Essayez avec ce compte."}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"fsthilaire"}),"\n",(0,s.jsx)(r.li,{children:"Native3!"}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["La vue ",(0,s.jsx)(r.strong,{children:"Liste des cartes"})," est affich\xe9e."]})]})}function c(e={}){const{wrapper:r}={...(0,i.a)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,r,n)=>{n.d(r,{Z:()=>o,a:()=>a});var s=n(7294);const i={},t=s.createContext(i);function a(e){const r=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);