"use strict";(self.webpackChunknotes_de_cours_4_n_1_2024=self.webpackChunknotes_de_cours_4_n_1_2024||[]).push([[5270],{4699:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var t=r(5893),i=r(1151);const s={sidebar_position:10},a="Bogus",l={id:"G\xe9n\xe9ration de donn\xe9es de test/Bogus_intro",title:"Bogus",description:"Pour g\xe9n\xe9rer une grosse quantit\xe9 de donn\xe9es, il n'est pas r\xe9aliste de le faire manuellement.",source:"@site/docs/55-G\xe9n\xe9ration de donn\xe9es de test/Bogus_intro.md",sourceDirName:"55-G\xe9n\xe9ration de donn\xe9es de test",slug:"/G\xe9n\xe9ration de donn\xe9es de test/Bogus_intro",permalink:"/4N1_2024/docs/G\xe9n\xe9ration de donn\xe9es de test/Bogus_intro",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"NotesSidebar",previous:{title:"Vue",permalink:"/4N1_2024/docs/Entity Framework 2/EF_vue"},next:{title:"Introduction",permalink:"/4N1_2024/docs/WPF partie 2/wpf2_xaml"}},o={},d=[{value:"Base de donn\xe9es exemple",id:"base-de-donn\xe9es-exemple",level:2},{value:"Nouvelle application console",id:"nouvelle-application-console",level:2},{value:"G\xe9n\xe9ration du contexte",id:"g\xe9n\xe9ration-du-contexte",level:3},{value:"Fichier Program.cs",id:"fichier-programcs",level:3},{value:"Bogus",id:"bogus-1",level:2},{value:"Installation de la librairie",id:"installation-de-la-librairie",level:2},{value:"Classe Generateur",id:"classe-generateur",level:2},{value:"Validation",id:"validation",level:2},{value:"Extension de string - Tronquer",id:"extension-de-string---tronquer",level:3},{value:"Table Collection",id:"table-collection",level:2},{value:"Test",id:"test",level:3},{value:"Table Editeur",id:"table-editeur",level:2},{value:"Test",id:"test-1",level:3},{value:"Am\xe9lioration - Utilisation d&#39;une propri\xe9t\xe9 de r\xe9f\xe9rence",id:"am\xe9lioration---utilisation-dune-propri\xe9t\xe9-de-r\xe9f\xe9rence",level:3},{value:"Table Auteur",id:"table-auteur",level:2},{value:"Test",id:"test-2",level:3},{value:"Table Livre",id:"table-livre",level:2},{value:"Test",id:"test-3",level:3},{value:"La table LivreAuteur",id:"la-table-livreauteur",level:2},{value:"Modification de LivreGenerateur",id:"modification-de-livregenerateur",level:3},{value:"Test",id:"test-4",level:2},{value:"Table Magasin et Inventaire",id:"table-magasin-et-inventaire",level:2},{value:"MagaginGenerateur",id:"magagingenerateur",level:3},{value:"InventaireGenerateur",id:"inventairegenerateur",level:3},{value:"Test",id:"test-5",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"bogus",children:"Bogus"}),"\n",(0,t.jsx)(n.p,{children:"Pour g\xe9n\xe9rer une grosse quantit\xe9 de donn\xe9es, il n'est pas r\xe9aliste de le faire manuellement."}),"\n",(0,t.jsx)(n.p,{children:"Les donn\xe9es cr\xe9\xe9es manuellement n'auront pas de grandes variabilit\xe9s et seront peu cr\xe9dibles pour un utilisateur."}),"\n",(0,t.jsxs)(n.p,{children:["Il existe des librairies de g\xe9n\xe9ration de donn\xe9es. Elles sont appel\xe9es ",(0,t.jsx)(n.strong,{children:"Faker"})," dans la plupart des cas."]}),"\n",(0,t.jsxs)(n.p,{children:["Une librairie populaire pour ",(0,t.jsx)(n.strong,{children:"CSHARP"})," est ",(0,t.jsx)(n.strong,{children:"Bogus"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Pour plus d'information sur la librairie : ",(0,t.jsx)(n.a,{href:"https://github.com/bchavez/Bogus",children:"https://github.com/bchavez/Bogus"})]}),"\n",(0,t.jsx)(n.p,{children:"La librairie contient une banque de donn\xe9es pour g\xe9n\xe9rer des noms de personnes, nom de villes, nom de compagnies, des num\xe9ros de t\xe9l\xe9phone, des phrases..."}),"\n",(0,t.jsx)(n.p,{children:"Il est toujours pr\xe9f\xe9rable d'utiliser une valeur proche de la r\xe9alit\xe9."}),"\n",(0,t.jsx)(n.h2,{id:"base-de-donn\xe9es-exemple",children:"Base de donn\xe9es exemple"}),"\n",(0,t.jsxs)(n.p,{children:["Pour ce document, une nouvelle base de donn\xe9es sera utilis\xe9e. La base de donn\xe9es est pour la gestion de livres dans des magasins. Elle contient tous les cas n\xe9cessaires pour le ",(0,t.jsx)(n.strong,{children:"TP 2"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Pour cet exemple, nous allons utiliser la m\xe9thode ",(0,t.jsx)(n.strong,{children:"Database first"})," afin de g\xe9n\xe9rer le mod\xe8le \xe0 partir de la base de donn\xe9es."]})}),"\n",(0,t.jsx)(n.p,{children:"Voici le DEA."}),"\n",(0,t.jsx)("img",{src:"/4N1_2024/img/11_dea_livre.jpg"}),"\n",(0,t.jsx)(n.p,{children:"Voici le script pour cr\xe9er une base de donn\xe9es."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"--IMPORTANT, ne pas oublier de mettre votre eDA apr\xe8s le nom de la BD\r\n\r\nIF DB_ID('eDA_4N1_GestionLivre') IS NULL ----Mettre votre eDA\r\n\tCREATE DATABASE eDA_4N1_GestionLivre ----Mettre votre eDA\r\nGO\r\n\r\nUSE eDA_4N1_GestionLivre\r\nGO\r\n\r\n\r\nIF OBJECT_ID('LivreAuteur', 'U') IS NOT NULL DROP TABLE LivreAuteur\r\nIF OBJECT_ID('Inventaire', 'U') IS NOT NULL DROP TABLE Inventaire\r\nIF OBJECT_ID('Auteur', 'U') IS NOT NULL DROP TABLE Auteur\r\nIF OBJECT_ID('Magasin', 'U') IS NOT NULL DROP TABLE Magasin\r\nIF OBJECT_ID('Livre', 'U') IS NOT NULL DROP TABLE Livre\r\nIF OBJECT_ID('Editeur', 'U') IS NOT NULL DROP TABLE Editeur\r\nIF OBJECT_ID('Collection', 'U') IS NOT NULL DROP TABLE [Collection]\r\nGO\r\n\r\nCREATE TABLE [Collection]\r\n(\r\n\tCollectionId INT NOT NULL CONSTRAINT PK_Collection PRIMARY KEY IDENTITY,\r\n\tNomCollection VARCHAR(50) NOT NULL,\r\n\t[Description] VARCHAR(250) NULL\r\n);\r\n\r\nCREATE TABLE Editeur\r\n(\r\n\tEditeurId INT NOT NULL CONSTRAINT PK_Editeur PRIMARY KEY IDENTITY,\r\n\tNom VARCHAR(150) NOT NULL,\r\n\tSiteWeb VARCHAR(3000) NOT NULL,\r\n\tTelephone VARCHAR(15) NOT NULL\r\n);\r\n\r\nCREATE TABLE Livre\r\n(\r\n\tLivreId INT NOT NULL CONSTRAINT PK_Livre PRIMARY KEY IDENTITY,\r\n\tTitre VARCHAR(100) NOT NULL,\r\n\t[Resume] VARCHAR(5000) NOT NULL,\r\n\tDatePublication DATE NOT NULL,\r\n\tPrix DECIMAL(5,2) NOT NULL,\r\n\tNbPage SMALLINT NOT NULL,\r\n\tCategorie VARCHAR(30) NOT NULL CONSTRAINT CK_Livre_Categorie CHECK(Categorie IN ('Jeunesse', 'Biographie', 'Policier')),\r\n\tCollectionId INT NOT NULL CONSTRAINT FK_Livre_CollectionId FOREIGN KEY REFERENCES [Collection](CollectionId),\r\n\tEditeurId INT NOT NULL CONSTRAINT FK_Livre_EditeurId FOREIGN KEY REFERENCES Editeur(EditeurId)\r\n);\r\n\r\nCREATE TABLE Magasin\r\n(\r\n\tMagasinId INT NOT NULL CONSTRAINT PK_MAgasin PRIMARY KEY IDENTITY,\r\n\tNom VARCHAR(150) NOT NULL,\r\n\tAdresse VARCHAR(100) NOT NULL,\r\n\tVille  VARCHAR(100) NOT NULL,\r\n\tCodePostal CHAR(7) NOT NULL\r\n);\r\n\r\nCREATE TABLE Auteur\r\n(\r\n\tAuteurId INT NOT NULL CONSTRAINT PK_Auteur PRIMARY KEY IDENTITY,\r\n\tPrenom VARCHAR(50) NOT NULL,\r\n\tNom VARCHAR(50) NOT NULL,\r\n\tBiographie VARCHAR(5000) NULL,\r\n\tDateNaissance DATE NOT NULL,\r\n\tDateDeces DATE NULL\r\n);\r\n\r\nCREATE TABLE Inventaire\r\n(\r\n\tLivreId INT NOT NULL CONSTRAINT FK_Inventaire_LivreId FOREIGN KEY REFERENCES Livre(LivreId),\r\n\tMagasinId INT NOT NULL CONSTRAINT FK_Inventaire_MagasinId FOREIGN KEY REFERENCES Magasin(MagasinId),\r\n\tQuantite SMALLINT NOT NULL,\r\n\tCONSTRAINT PK_Inventaire PRIMARY KEY(LivreId, MagasinId)\r\n);\r\n\r\nCREATE TABLE LivreAuteur\r\n(\r\n\tLivreId INT NOT NULL CONSTRAINT FK_LivreAuteur_LivreId FOREIGN KEY REFERENCES Livre(LivreId),\r\n\tAuteurId INT NOT NULL CONSTRAINT FK_LivreAuteur_AuteurId FOREIGN KEY REFERENCES Auteur(AuteurId),\r\n\tCONSTRAINT PK_LivreAuteur PRIMARY KEY(LivreId, AuteurId)\r\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"nouvelle-application-console",children:"Nouvelle application console"}),"\n",(0,t.jsx)(n.p,{children:"Cr\xe9ez une application console."}),"\n",(0,t.jsxs)(n.p,{children:["Nommez cette application ",(0,t.jsx)(n.strong,{children:"GenerateurBDGestionLivre"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Cette application utilisera directement le contexte et les g\xe9n\xe9rateurs."}),"\n",(0,t.jsx)(n.h3,{id:"g\xe9n\xe9ration-du-contexte",children:"G\xe9n\xe9ration du contexte"}),"\n",(0,t.jsx)(n.p,{children:"Installez les 2 librairies ci-dessous."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"Install-Package Microsoft.EntityFrameworkCore.SqlServer\r\nInstall-Package Microsoft.EntityFrameworkCore.Tools\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Ensuite, g\xe9n\xe9rez le contexte avec ",(0,t.jsx)(n.strong,{children:"Scaffold-Dbcontext"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Voici la commande sans l'erreur du ",(0,t.jsx)(n.strong,{children:"SSL"}),". Pensez \xe0 utiliser votre DA."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:'Scaffold-DbContext "Server=localhost\\SQLExpress;Database=eDA_4N1_GestionLivre;Trusted_Connection=True;" Microsoft.EntityFrameworkCore.SqlServer -Context GestionLivreContext -OutputDir Data -ContextDir Data\\Context -NoPluralize -Force\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Voici  la commande si vous avez l'erreur du ",(0,t.jsx)(n.strong,{children:"SSL"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:'Scaffold-DbContext "Server=localhost\\SQLExpress;Database=eDA_4N1_GestionLivre;Trusted_Connection=True;Trust Server Certificate=true;" Microsoft.EntityFrameworkCore.SqlServer -Context GestionLivreContext -OutputDir Data -ContextDir Data\\Context -NoPluralize -Force\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Cette commande va g\xe9n\xe9rer le contexte ainsi que les classes pour repr\xe9senter la bd dans le sous-r\xe9pertoire ",(0,t.jsx)(n.strong,{children:"Data"})," du projet."]}),"\n",(0,t.jsx)(n.h3,{id:"fichier-programcs",children:"Fichier Program.cs"}),"\n",(0,t.jsxs)(n.p,{children:["Modifiez le fichier ",(0,t.jsx)(n.strong,{children:"Program.cs"})," pour celui-ci."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"using GenerateurBDGestionLivre.Data.Context;\r\n\r\nusing (GestionLivreContext db = new GestionLivreContext())\r\n{\r\n    //Logique\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"bogus-1",children:"Bogus"}),"\n",(0,t.jsx)(n.p,{children:"Lorsqu'un g\xe9n\xe9rateur de donn\xe9es est utilis\xe9, il est important d'avoir des donn\xe9es r\xe9alistes. Si les donn\xe9es n'ont aucun sens, il sera difficile \xe0 l'utilisateur de comprendre les diff\xe9rents champs des formulaires et des listes de l'application."}),"\n",(0,t.jsxs)(n.p,{children:["La librairie ",(0,t.jsx)(n.strong,{children:"Bogus"})," contient plusieurs modules pour g\xe9n\xe9rer des donn\xe9es en fonction d'un th\xe8me. En voici quelques-uns."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Company : En lien avec des compagnies"}),"\n",(0,t.jsx)(n.li,{children:"Address : En lien avec les adresses."}),"\n",(0,t.jsx)(n.li,{children:"Name : En lien avec des personnes."}),"\n",(0,t.jsx)(n.li,{children:"Lorem : En lien avec de la g\xe9n\xe9ration de mots ou de textes."}),"\n",(0,t.jsx)(n.li,{children:"Finance : En lien avec des achats."}),"\n",(0,t.jsx)(n.li,{children:"Date : En lien avec les dates"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Pour avoir les ",(0,t.jsx)(n.strong,{children:"modules disponibles"})," pour avoir des donn\xe9es r\xe9alistes, veuillez consulter la liste : ",(0,t.jsx)(n.a,{href:"https://github.com/bchavez/Bogus#bogus-api-support",children:"https://github.com/bchavez/Bogus#bogus-api-support"})]}),"\n",(0,t.jsx)(n.p,{children:"Il est donc important de choisir la bonne librairie pour g\xe9n\xe9rer des valeurs en fonction du champ."}),"\n",(0,t.jsx)(n.p,{children:"Il est possible d'ajouter de la logique au g\xe9n\xe9rateur pour avoir des donn\xe9es plus r\xe9alistes encore."}),"\n",(0,t.jsxs)(n.p,{children:["La librairie ",(0,t.jsx)(n.strong,{children:"Bogus"})," g\xe9n\xe8re des valeurs pour des objets et non directement pour une base de donn\xe9es. Lorsqu'une application utilise un ",(0,t.jsx)(n.strong,{children:"ORM"}),", il est possible d'utiliser un g\xe9n\xe9rateur d'objet sur les classes du mod\xe8le. Ces objets peuvent \xeatre ensuite ajout\xe9s \xe0 la base de donn\xe9es."]}),"\n",(0,t.jsx)(n.h2,{id:"installation-de-la-librairie",children:"Installation de la librairie"}),"\n",(0,t.jsxs)(n.p,{children:["Dans la ",(0,t.jsx)(n.strong,{children:"Console du Gestionnaire de package"}),", inscrivez ceci."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"Install-Package Bogus\n"})}),"\n",(0,t.jsx)(n.h2,{id:"classe-generateur",children:"Classe Generateur"}),"\n",(0,t.jsxs)(n.p,{children:["Dans ce document, les g\xe9n\xe9rateurs seront cr\xe9\xe9s par h\xe9ritage de la classe ",(0,t.jsx)(n.strong,{children:"Faker<T>"}),". Le ",(0,t.jsx)(n.strong,{children:"<T>"})," correspond \xe0 la classe du g\xe9n\xe9rateur."]}),"\n",(0,t.jsxs)(n.p,{children:["Dans la documentation de ",(0,t.jsx)(n.strong,{children:"Bogus"}),", il existe plusieurs techniques. Par contre, celle par h\xe9ritage permet de cr\xe9er une classe qui contient toute la logique de g\xe9n\xe9ration de donn\xe9es."]}),"\n",(0,t.jsx)(n.p,{children:"La classe est s\xe9par\xe9e en 3 sections."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Constructeurs"})}),"\n",(0,t.jsx)(n.p,{children:"Le constructeur permet d'associer une propri\xe9t\xe9 \xe0 une m\xe9thode de g\xe9n\xe9ration."}),"\n",(0,t.jsxs)(n.p,{children:["La m\xe9thode ",(0,t.jsx)(n.strong,{children:"RuleFor(i => i.[Propriete], Gen[Propriete])"})," permet de faire le lien."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"M\xe9thode de g\xe9n\xe9ration"})}),"\n",(0,t.jsx)(n.p,{children:"La m\xe9thode de g\xe9n\xe9ration contient la logique pour g\xe9n\xe9rer une valeur pour une propri\xe9t\xe9."}),"\n",(0,t.jsxs)(n.p,{children:["La m\xe9thode aura cette signature ",(0,t.jsx)(n.strong,{children:"[Type Propriete] Gen[Propriete](Faker f)"})," ."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"M\xe9thode d'assignation des d\xe9pendances (cl\xe9 \xe9trang\xe8re) - facultatif"})}),"\n",(0,t.jsx)(n.p,{children:"Une m\xe9thode d'assignation des d\xe9pendances permet d'indiquer les d\xe9pendances disponibles pour cette classe."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"validation",children:"Validation"}),"\n",(0,t.jsx)(n.p,{children:"Il est important que le donn\xe9es g\xe9n\xe9r\xe9es soient valides pour la base de donn\xe9es."}),"\n",(0,t.jsx)(n.p,{children:"Il faut que les contraintes de type et sp\xe9cifiques soient respect\xe9es."}),"\n",(0,t.jsx)(n.p,{children:"Il est possible d'utiliser des librairies sp\xe9cialis\xe9es pour ceci."}),"\n",(0,t.jsx)(n.h3,{id:"extension-de-string---tronquer",children:"Extension de string - Tronquer"}),"\n",(0,t.jsxs)(n.p,{children:["Pour la longueur maximale des chaines de caract\xe8res, il faudra ",(0,t.jsx)(n.strong,{children:"tronquer"})," la chaine si elle est trop grande."]}),"\n",(0,t.jsxs)(n.p,{children:["Cr\xe9ez la classe d'extension ",(0,t.jsx)(n.strong,{children:"StringExtensions"})," directement dans le projet."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'namespace GenerateurBDGestionLivre;\r\n\r\n/// <summary>\r\n/// Classe qui contient les extensions pour les donn\xe9es de type string\r\n/// </summary>\r\npublic static class StringExtensions\r\n{\r\n    /// <summary>\r\n    /// Permet de tronquer une string\r\n    /// </summary>\r\n    /// <param name="s">string \xe0 tronquer</param>\r\n    /// <param name="maxLongueur">Longueur maximum de la chaine</param>\r\n    /// <returns>string tronqu\xe9</returns>\r\n    public static string? Tronquer(this string? s, int maxLongueur)\r\n    {\r\n        //Verifie si la chaine est plus grande que la longueur maximale\r\n        if (s?.Length > maxLongueur)\r\n        {\r\n            //La chaine est plus grande que la longueur maximamle\r\n            //Retourne uniquement la partie de la longueur maximale\r\n            return s.Substring(0, maxLongueur);\r\n        }\r\n        else\r\n        {\r\n            //La chaine est plus petite que la longueur maximale\r\n            //Retourne la chaine originale\r\n            return s;\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"table-collection",children:"Table Collection"}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Collection"})," consiste aux collections de livres. G\xe9n\xe9ralement, un livre fait partie d'une collection de livres."]}),"\n",(0,t.jsx)(n.p,{children:"La table poss\xe8de 2 champs."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"NomCollection"})}),"\n",(0,t.jsxs)(n.p,{children:["Le meilleur g\xe9n\xe9rateur pour le nom d'une collection serait un g\xe9n\xe9rateur de mots dans le module ",(0,t.jsx)(n.strong,{children:"Random"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description"})}),"\n",(0,t.jsxs)(n.p,{children:["Le meilleur g\xe9n\xe9rateur pour la description serait un g\xe9n\xe9rateur de phrase dans le module ",(0,t.jsx)(n.strong,{children:"Lorem"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Cr\xe9ez la classe ",(0,t.jsx)(n.strong,{children:"CollectionGenerateur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"using Bogus;\r\nusing GenerateurBDGestionLivre.Data;\r\n\r\nnamespace GenerateurBDGestionLivre;\r\n\r\npublic class CollectionGenerateur : Faker<Collection>\r\n{\r\n\tpublic CollectionGenerateur()\r\n\t{\r\n\t\t//Pour faire l'association entre une propri\xe9t\xe9 et une m\xe9thode de g\xe9n\xe9ration, il faut utiliser la m\xe9thode RuleFor\r\n\t\tRuleFor(i => i.NomCollection, GenNomCollection);\r\n\t\tRuleFor(i => i.Description, GenDescription);\r\n\t}\r\n\r\n\tpublic Collection Generer()\r\n\t{\r\n\t\treturn base.Generate();\r\n\t}\r\n\r\n\tprivate string GenNomCollection(Faker f)\r\n\t{\r\n\t\t//La m\xe9thode Words permet de g\xe9n\xe9rer des mots.\r\n\t\t//Si aucun param\xe8tre n'est sp\xe9cifi\xe9, il y aura entre 1 et 3 mots.\r\n\t\t//Le type est VARCHAR(50)\r\n\t\treturn f.Random.Words().Tronquer(50)!;\r\n\t}\r\n\r\n\tprivate string? GenDescription(Faker f)\r\n\t{\r\n        //La m\xe9thode Sentence permet de g\xe9n\xe9rer une phrase de quelques mots.\r\n        //Le type est VARCHAR(250)\r\n\t\t//La probabilit\xe9 du null est de 20%\r\n        return f.Lorem.Sentence().Tronquer(250).OrNull(f, 0.2f);\r\n\t}\r\n}\r\n\n"})}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Collection"})," n'a aucune d\xe9pendance. Elle a donc seulement le constructeur et les m\xe9thodes de g\xe9n\xe9ration."]}),"\n",(0,t.jsxs)(n.p,{children:["Ce g\xe9n\xe9rateur est assez simple, car les modules de ",(0,t.jsx)(n.strong,{children:"Bogus"})," sont suffisants pour cr\xe9er des donn\xe9es."]}),"\n",(0,t.jsx)(n.p,{children:"Voici le constructeur."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER, C\'EST D\xc9J\xc0 DANS LE CODE"',children:"public CollectionGenerateur()\r\n{\r\n\t//Pour faire l'association entre une propri\xe9t\xe9 et une m\xe9thode de g\xe9n\xe9ration, il faut utiliser la m\xe9thode RuleFor\r\n\tRuleFor(i => i.NomCollection, GenNomCollection);\r\n\tRuleFor(i => i.Description, GenDescription);\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Il y a 2 propri\xe9t\xe9s \xe0 g\xe9n\xe9rer pour la classe ",(0,t.jsx)(n.strong,{children:"Collection"}),". Si la cl\xe9 primaire est ",(0,t.jsx)(n.strong,{children:"autog\xe9n\xe9r\xe9e"})," par la base de donn\xe9es, il est important de ne pas la g\xe9n\xe9rer avec ",(0,t.jsx)(n.strong,{children:"Bogus"}),". Il faut g\xe9n\xe9rer uniquement les propri\xe9t\xe9s qu'un utilisateur sp\xe9cifierait normalement."]}),"\n",(0,t.jsxs)(n.p,{children:["Pour la propri\xe9t\xe9 ",(0,t.jsx)(n.strong,{children:"NomCollection"}),", ce sera un g\xe9n\xe9rateur de mots."]}),"\n",(0,t.jsxs)(n.p,{children:["Il est important que les mots ne d\xe9passent pas le 50 caract\xe8res, car le type ",(0,t.jsx)(n.strong,{children:"SQL"})," est ",(0,t.jsx)(n.strong,{children:"VARCHAR(50)"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER, C\'EST D\xc9J\xc0 DANS LE CODE"',children:"private string GenNomCollection(Faker f)\r\n{\r\n\t//La m\xe9thode Words permet de g\xe9n\xe9rer des mots.\r\n\t//Si aucun param\xe8tre n'est sp\xe9cifi\xe9, il y aura entre 1 et 3 mots.\r\n\t//Le type est VARCHAR(50)\r\n\treturn f.Random.Words().Tronquer(50)!;\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Pour la propri\xe9t\xe9 ",(0,t.jsx)(n.strong,{children:"Description"}),", ce sera une phrase."]}),"\n",(0,t.jsxs)(n.p,{children:["Il est important que la phrase ne d\xe9passe pas le 250 caract\xe8res, car le type ",(0,t.jsx)(n.strong,{children:"SQL"})," est ",(0,t.jsx)(n.strong,{children:"VARCHAR(250)"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Une autre particularit\xe9 est que le champ peut \xeatre ",(0,t.jsx)(n.strong,{children:"null"})," dans la base de donn\xe9es. Il faut que le g\xe9n\xe9rateur en tienne compte pour avoir une variabilit\xe9 dans les donn\xe9es."]}),"\n",(0,t.jsxs)(n.p,{children:["La m\xe9thode ",(0,t.jsx)(n.strong,{children:"OrNull(f, [probabilite])"})," permet d'indiquer la probabilit\xe9 d'obtenir une valeur nulle. Il faut envoyer dans la m\xe9thode le ",(0,t.jsx)(n.strong,{children:"Faker"})," de la m\xe9thode."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER, C\'EST D\xc9J\xc0 DANS LE CODE"',children:"private string? GenDescription(Faker f)\r\n{\r\n    //La m\xe9thode Sentence permet de g\xe9n\xe9rer une phrase de quelques mots.\r\n    //Le type est VARCHAR(250)\r\n\t//La probabilit\xe9 du null est de 20%\r\n    return f.Lorem.Sentence().Tronquer(250).OrNull(f, 0.2f);\r\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"test",children:"Test"}),"\n",(0,t.jsxs)(n.p,{children:["Modifiez le fichier ",(0,t.jsx)(n.strong,{children:"Program.cs"})," pour ceci."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using GenerateurBDGestionLivre;\r\nusing GenerateurBDGestionLivre.Data;\r\nusing GenerateurBDGestionLivre.Data.Context;\r\n\r\nusing (GestionLivreContext db = new GestionLivreContext())\r\n{\r\n    CollectionGenerateur generateur = new CollectionGenerateur();\r\n\r\n    for(int i = 0; i < 10; i++)\r\n    {\r\n        Collection collection = generateur.Generer();        \r\n\r\n        Console.WriteLine($"NomCollection : {collection.NomCollection}");\r\n        Console.WriteLine($"Description : {collection.Description}");\r\n        Console.WriteLine();\r\n\r\n        //Ajoute dans la base de donn\xe9es\r\n        db.Add(collection);\r\n        //Enregistre dans la base de donn\xe9es\r\n        db.SaveChanges();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Ex\xe9cutez le programme."}),"\n",(0,t.jsx)(n.p,{children:"Voici un exemple de g\xe9n\xe9ration."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"NomCollection : Checking Account\r\nDescription : In aliquam quasi quisquam molestiae.\r\n\r\nNomCollection : Ouguiya Garden Savings Account\r\nDescription : Ab dolor non ullam hic sunt sit.\r\n\r\nNomCollection : Mountain\r\nDescription :\r\n\r\nNomCollection : payment\r\nDescription : \r\n\r\nNomCollection : capability\r\nDescription : Repellat quas qui omnis rerum.\r\n\r\nNomCollection : Wooden\r\nDescription :\r\n\r\nNomCollection : SAS\r\nDescription : Non ipsum iure autem corporis.\r\n\r\nNomCollection : dynamic Global navigate\r\nDescription : Suscipit consequatur delectus.\r\n\r\nNomCollection : Indonesia productivity California\r\nDescription : Laudantium architecto sit deserunt necessitatibus quae.\r\n\r\nNomCollection : white\r\nDescription : Sapiente quo magni repellendus natus qui voluptates.\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Des mots aux hasards et des phrases en ",(0,t.jsx)(n.strong,{children:"Lorem"}),", ce n'est peut-\xeatre pas le plus ",(0,t.jsx)(n.strong,{children:"r\xe9aliste"}),", mais \xe7a permet d'avoir des donn\xe9es ",(0,t.jsx)(n.strong,{children:"vraisemblables"})," pour la base de donn\xe9es."]}),"\n",(0,t.jsxs)(n.p,{children:["Ouvrez ",(0,t.jsx)(n.strong,{children:"SSMS"})," et effectuez la requ\xeate ci-dessous pour voir les donn\xe9es."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM [Collection];\n"})}),"\n",(0,t.jsx)(n.h2,{id:"table-editeur",children:"Table Editeur"}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Editeur"})," consiste aux \xe9diteurs de livres."]}),"\n",(0,t.jsx)(n.p,{children:"La table poss\xe8de 3 champs."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Nom"})}),"\n",(0,t.jsxs)(n.p,{children:["Le meilleur g\xe9n\xe9rateur pour le nom d'une collection serait un g\xe9n\xe9rateur de nom de compagnie dans le module ",(0,t.jsx)(n.strong,{children:"Company"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"SiteWeb"})}),"\n",(0,t.jsxs)(n.p,{children:["Le meilleur g\xe9n\xe9rateur pour le site web serait un g\xe9n\xe9rateur de Url dans le module ",(0,t.jsx)(n.strong,{children:"Internet"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Telephone"})}),"\n",(0,t.jsxs)(n.p,{children:["Le meilleur g\xe9n\xe9rateur pour le t\xe9l\xe9phone serait un g\xe9n\xe9rateur de t\xe9l\xe9phone dans le module ",(0,t.jsx)(n.strong,{children:"Phone"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Cr\xe9ez la classe ",(0,t.jsx)(n.strong,{children:"EditeurGenerateur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using Bogus;\r\nusing GenerateurBDGestionLivre.Data;\r\n\r\nnamespace GenerateurBDGestionLivre;\r\n\r\npublic class EditeurGenerateur : Faker<Editeur>\r\n{\r\n\tpublic EditeurGenerateur()\r\n\t{\r\n\t\tRuleFor(i => i.Nom, GenNom);\r\n\t\tRuleFor(i => i.SiteWeb, GenSiteWeb);\r\n\t\tRuleFor(i => i.Telephone, GenTelephone);\r\n\t}\r\n\r\n\tpublic Editeur Generer()\r\n\t{\r\n\t\treturn base.Generate();\r\n\t}\r\n\r\n\tprivate string GenNom(Faker f)\r\n\t{\r\n\t\t//La m\xe9thode CompanyName permet de g\xe9n\xe9rer un nom de compagnie\r\n\t\t//Le type est VARCHAR(150)\r\n\t\treturn f.Company.CompanyName().Tronquer(150)!;\r\n\t}\r\n\r\n\tprivate string GenSiteWeb(Faker f)\r\n\t{\r\n\t\t//La m\xe9thode Url permet de g\xe9n\xe9rer une adresse internet\r\n\t\t//Le type est VARCHAR(3000)\r\n\t\treturn f.Internet.Url().Tronquer(3000)!;\r\n\t}\r\n\r\n\tprivate string GenTelephone(Faker f)\r\n\t{\r\n\t\t//La m\xe9thode PhoneNumber peut avoir un format en param\xe8tre.\r\n\t\treturn f.Phone.PhoneNumber("###-###-####");\r\n\t}\r\n}\r\n\n'})}),"\n",(0,t.jsx)(n.p,{children:"La plupart des m\xe9thodes ont la possibilit\xe9 de mettre des param\xe8tres."}),"\n",(0,t.jsxs)(n.p,{children:["Par exemple, ",(0,t.jsx)(n.strong,{children:"CompanyName()"})," peut avoir 3 formats diff\xe9rents. Si aucun param\xe8tre n'est sp\xe9cifi\xe9, les 3 formats de nom de compagnie seront utilis\xe9s."]}),"\n",(0,t.jsxs)(n.p,{children:["Pour le t\xe9l\xe9phone, il aurait \xe9t\xe9 possible d'utiliser le format ",(0,t.jsx)(n.strong,{children:"(###) ###-####"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"test-1",children:"Test"}),"\n",(0,t.jsxs)(n.p,{children:["Modifiez le fichier ",(0,t.jsx)(n.strong,{children:"Program.cs"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using GenerateurBDGestionLivre;\r\nusing GenerateurBDGestionLivre.Data;\r\nusing GenerateurBDGestionLivre.Data.Context;\r\n\r\nusing (GestionLivreContext db = new GestionLivreContext())\r\n{\r\n    EditeurGenerateur generateur = new EditeurGenerateur();\r\n\r\n    for(int i = 0; i < 10; i++)\r\n    {\r\n        Editeur editeur = generateur.Generer();        \r\n\r\n        Console.WriteLine($"Nom : {editeur.Nom}");\r\n        Console.WriteLine($"Site Web : {editeur.SiteWeb}");\r\n        Console.WriteLine($"T\xe9l\xe9phone : {editeur.Telephone}");\r\n        Console.WriteLine();\r\n\r\n        //Ajoute dans la base de donn\xe9es\r\n        db.Add(editeur);\r\n        //Enregistre dans la base de donn\xe9es\r\n        db.SaveChanges();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Voici un exemple de donn\xe9es g\xe9n\xe9r\xe9es."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Nom : Langosh and Sons\r\nSite Web : http://milton.org\r\nT\xe9l\xe9phone : 730-694-1027\r\n\r\nNom : Boyle, Osinski and Nikolaus\r\nSite Web : https://mayra.org\r\nT\xe9l\xe9phone : 453-503-9297\r\n\r\nNom : Muller, Green and Harvey\r\nSite Web : https://erin.info\r\nT\xe9l\xe9phone : 464-434-7270\r\n\r\nNom : Farrell, Ortiz and Kiehn\r\nSite Web : https://savanna.net\r\nT\xe9l\xe9phone : 997-180-1888\r\n\r\nNom : Cronin, Kovacek and Stoltenberg\r\nSite Web : https://maverick.info\r\nT\xe9l\xe9phone : 388-588-0080\r\n\r\nNom : Mohr - Krajcik\r\nSite Web : http://joesph.org\r\nT\xe9l\xe9phone : 161-910-4126\r\n\r\nNom : Kris - Gleichner\r\nSite Web : https://ramona.info\r\nT\xe9l\xe9phone : 006-236-8048\r\n\r\nNom : Homenick LLC\r\nSite Web : http://kirsten.biz\r\nT\xe9l\xe9phone : 445-092-6921\r\n\r\nNom : O'Reiley Group\r\nSite Web : http://connor.biz\r\nT\xe9l\xe9phone : 159-528-4460\r\n\r\nNom : Paucek - Abernathy\r\nSite Web : https://kaley.net\r\nT\xe9l\xe9phone : 133-806-2671\n"})}),"\n",(0,t.jsx)(n.h3,{id:"am\xe9lioration---utilisation-dune-propri\xe9t\xe9-de-r\xe9f\xe9rence",children:"Am\xe9lioration - Utilisation d'une propri\xe9t\xe9 de r\xe9f\xe9rence"}),"\n",(0,t.jsxs)(n.p,{children:["Le site web n'a aucun lien avec le nom de la compagnie. Il serait int\xe9ressant que le nom de la compagnie soit dans le ",(0,t.jsx)(n.strong,{children:"Url"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Il y a 3 options."}),"\n",(0,t.jsx)(n.p,{children:"1- On transforme le nom de la compagnie pour le mettre en domaine."}),"\n",(0,t.jsx)(n.p,{children:"Il faut s'assurer d'\xe9liminer tous les caract\xe8res probl\xe9matiques."}),"\n",(0,t.jsxs)(n.p,{children:["Dans l'exemple ci-dessus, il y a : ",(0,t.jsx)(n.strong,{children:", `  -"})," et l'espace."]}),"\n",(0,t.jsx)(n.p,{children:"2- On g\xe9n\xe8re une adresse internet et la portion domaine devient le nom de la compagnie."}),"\n",(0,t.jsx)(n.p,{children:"3- On g\xe9n\xe8re le nom de la compagnie \xe0 partir de mots de domaine."}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Internet"})," permet de g\xe9n\xe9rer des mots de domaine. Il serait ensuite possible d'appliquer l'option 1 \xe0 partir de ces mots sans se soucier d'\xe9liminer les caract\xe8res."]}),"\n",(0,t.jsx)(n.p,{children:"Les 3 approches d\xe9pendent d'une autre propri\xe9t\xe9 pour se g\xe9n\xe9rer."}),"\n",(0,t.jsx)(n.p,{children:"Pour cet exemple, l'option 3 sera utilis\xe9e."}),"\n",(0,t.jsxs)(n.p,{children:["L'ordre des ",(0,t.jsx)(n.strong,{children:"RuleFor"})," est important dans ce cas-ci, car il faut g\xe9n\xe9rer le nom de la compagnie avant le domaine."]}),"\n",(0,t.jsxs)(n.p,{children:["Voici la nouvelle m\xe9thode ",(0,t.jsx)(n.strong,{children:"GenNom()"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'private string GenNom(Faker f)\r\n{\r\n\t//Le nombre de mots sera al\xe9atoire (entre 1 et 4)\r\n\t//Il faut mettre la premi\xe8re lettre du nom en majuscule\r\n\r\n\tint nbMot = f.Random.Number(1, 4);\r\n\tstring[] mots = new string[nbMot];\r\n\r\n\tfor(int i = 0; i < nbMot; i++)\r\n\t{\r\n\t\tmots[i] = f.Internet.DomainWord();\r\n\t}\t\t\t\t\t\t\r\n\r\n\tstring nom = string.Join(" ", mots);\r\n\r\n\t//Le type est VARCHAR(150)\r\n\treturn (nom.Substring(0, 1).ToUpper() + nom.Substring(1)).Tronquer(150)!;\r\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Voici la nouvelle m\xe9thode ",(0,t.jsx)(n.strong,{children:"GenSiteWeb()"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'private string GenSiteWeb(Faker f, Editeur editeur)\r\n{\r\n\t//Le type est VARCHAR(3000)\r\n\r\n\t//Les espaces du nom de l\'\xe9diteur peuvent \xeatre \xe9limin\xe9s ou remplac\xe9s par des tirets.\r\n\t//Il est possible de donn\xe9es des choix et de choisir en fonction d\'une probabilit\xe9.\r\n\r\n\t//Il est important que les 2 tableaux soient de la m\xeame longueur.\r\n\tstring[] choixRemplacement = { string.Empty, "-" };\r\n\t//La somme des probabilit\xe9s doit \xeatre 1.\r\n\t//60% de retirer l\'espace et 40% de mettre un tiret.\r\n\tfloat[] probabiliteRemplacement = { 0.6f, 0.4f };\r\n\r\n    //La m\xe9thode WeightedRandom permet de faire un choix dans une liste en fonction de probabilit\xe9 pour chacun des items.\r\n\tstring valeurRemplacement = f.Random.WeightedRandom(choixRemplacement, probabiliteRemplacement);\r\n\r\n    //La longueur maximale d\'un domaine est de 63\r\n\tstring domaine = editeur.Nom.ToLower().Replace(" ", valeurRemplacement).Tronquer(63)!;\r\n\r\n    //Ajoute \xe0 la fin un suffixe de domaine.\r\n    return ("https://www." + domaine + "." + f.Internet.DomainSuffix()).Tronquer(3000)!;\r\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Premi\xe8rement, la m\xe9thode a un 2e param\xe8tre. Il s'agit de l'instance ",(0,t.jsx)(n.strong,{children:"Editeur"})," en cours de cr\xe9ation."]}),"\n",(0,t.jsxs)(n.p,{children:["Ensuite, il est possible de remplacer les espaces du nom par des tirets ou de les retirer. Afin de varier le plus possible le domaine, l'utilisation de la m\xe9thode ",(0,t.jsx)(n.strong,{children:"WeightedRandom()"})," permet de mettre une probabilit\xe9 sur chaque possibilit\xe9.  Il y a donc 60% plus de chance de retirer l'espace."]}),"\n",(0,t.jsxs)(n.p,{children:["Finalement, la m\xe9thode ",(0,t.jsx)(n.strong,{children:"DomainSuffix()"})," permet de g\xe9n\xe9rer un ",(0,t.jsx)(n.strong,{children:".xyz"})," valide."]}),"\n",(0,t.jsx)(n.admonition,{title:"Attention",type:"warning",children:(0,t.jsx)(n.p,{children:"Avant de g\xe9n\xe9rer 10 nouveaux Editeurs, veuillez vider la table Editeur dans la bd."})}),"\n",(0,t.jsx)(n.p,{children:"Voici un exemple de g\xe9n\xe9ration."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Nom : Graciela\r\nSite Web : https://www.graciela.net\r\nT\xe9l\xe9phone : 126-633-0627\r\n\r\nNom : Nola eden buck elnora\r\nSite Web : https://www.nola-eden-buck-elnora.org\r\nT\xe9l\xe9phone : 170-125-8822\r\n\r\nNom : Helen\r\nSite Web : https://www.helen.name\r\nT\xe9l\xe9phone : 008-494-5413\r\n\r\nNom : Torrance earl\r\nSite Web : https://www.torranceearl.net\r\nT\xe9l\xe9phone : 340-024-2604\r\n\r\nNom : Pearl\r\nSite Web : https://www.pearl.info\r\nT\xe9l\xe9phone : 336-317-2160\r\n\r\nNom : Thelma delores cassidy randal\r\nSite Web : https://www.thelmadelorescassidyrandal.biz\r\nT\xe9l\xe9phone : 892-446-1812\n"})}),"\n",(0,t.jsx)(n.h2,{id:"table-auteur",children:"Table Auteur"}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Auteur"})," contient l'information d'un auteur d'un livre."]}),"\n",(0,t.jsx)(n.p,{children:"La table poss\xe8de 5 champs."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Nom"})," et ",(0,t.jsx)(n.strong,{children:"Prenom"})]}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Name"})," a des g\xe9n\xe9rateurs de noms de personne."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Biographie"})}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Lorem"})," peut g\xe9n\xe9rer des paragraphes."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"DateNaissance"})," et ",(0,t.jsx)(n.strong,{children:"DateDeces"})]}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Date"})," peut g\xe9n\xe9rer des dates."]}),"\n",(0,t.jsx)(n.p,{children:"La g\xe9n\xe9ration de la date de d\xe9c\xe8s d\xe9pend de la date de naissance."}),"\n",(0,t.jsx)(n.p,{children:"Il faut s'assurer que la date de d\xe9c\xe8s est plus r\xe9cente que la date de naissance."}),"\n",(0,t.jsx)(n.p,{children:"Il ne peut avoir aucune date dans le futur."}),"\n",(0,t.jsx)(n.p,{children:"Il faudrait \xe9galement s'assurer que si l'auteur est toujours en vie, que son \xe2ge soit vraisemblable."}),"\n",(0,t.jsx)(n.p,{children:"Si l'auteur est d\xe9c\xe9d\xe9, il faut que son \xe2ge soit vraisemblable \xe9galement."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Cr\xe9ez la classe ",(0,t.jsx)(n.strong,{children:"AuteurGenerateur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"using Bogus;\r\nusing GenerateurDBGestionLivre.Data;\r\n\r\nnamespace GenerateurBDGestionLivre;\r\n\r\npublic class AuteurGenerateur : Faker<Auteur>\r\n{\r\n    public AuteurGenerateur()\r\n    {\r\n        RuleFor(i => i.Prenom, GenPrenom);\r\n        RuleFor(i => i.Nom, GenNom);\r\n        RuleFor(i => i.Biographie, GenBiographie);\r\n        RuleFor(i => i.DateNaissance,  GenDateNaissance);\r\n        RuleFor(i => i.DateDeces, GenDateDeces);\r\n    }\r\n\r\n    public Auteur Generer()\r\n    {\r\n        return base.Generate();\r\n    }\r\n\r\n    private string GenPrenom(Faker f)\r\n    {\r\n        //VARCHAR(50)\r\n        return f.Name.FirstName().Tronquer(50)!;\r\n    }\r\n\r\n    private string GenNom(Faker f)\r\n    {\r\n        //VARCHAR(50)\r\n        return f.Name.LastName().Tronquer(50)!;\r\n    }\r\n\r\n    private string? GenBiographie(Faker f)\r\n    {\r\n        //VARCHAR(5000)\r\n        //30% d'obtenir un null\r\n        return f.Lorem.Paragraphs(1, 3).OrNull(f, 0.3f).Tronquer(5000)!;\r\n    }\r\n\r\n    private DateOnly GenDateNaissance(Faker f)\r\n    {\r\n        //La date peut \xeatre entre 1800-01-01 et 15 ans dans le pass\xe9.\r\n        return f.Date.BetweenDateOnly(new DateOnly(1800, 1, 1), DateOnly.FromDateTime(DateTime.Now).AddYears(-15));\r\n    }\r\n\r\n    private DateOnly? GenDateDeces(Faker f, Auteur auteur)\r\n    {\r\n        //V\xe9rifie si la date de naissance est il y a plus de 95 ans\r\n        if (DateTime.Now.Date.Year - auteur.DateNaissance.Year > 95)\r\n        {\r\n            //La date de naissance est il y a plus de 95 ans\r\n            //Il faut obligatoirement g\xe9n\xe9rer une date de d\xe9c\xe8s.\r\n            //L'auteur peut \xeatre mort entre 15 et 95 ans\r\n            return f.Date.BetweenDateOnly(auteur.DateNaissance.AddYears(15), auteur.DateNaissance.AddYears(95));\r\n        }\r\n        else\r\n        {\r\n            //La date de naissance est il y a 95 ans et moins.\r\n            //Il y a seulement 5% de chance qu'il soit d\xe9c\xe9d\xe9.\r\n\r\n            return f.Date.BetweenDateOnly(auteur.DateNaissance.AddYears(15), DateOnly.FromDateTime(DateTime.Now).AddDays(-5)).OrNull(f, 0.95f);\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Pour la m\xe9thode ",(0,t.jsx)(n.strong,{children:"GenDateNaissance()"})," le g\xe9n\xe9rateur ne peut pas g\xe9n\xe9rer des auteurs de moins de 15 ans."]}),"\n",(0,t.jsx)(n.p,{children:"Il serait possible d'optimiser les auteurs r\xe9cents en ajoutant beaucoup plus de logique. Il faut toujours se demander si les ajouts de logiques ont r\xe9ellement de la valeur. Dans ce cas-ci, il n'est pas n\xe9cessaire d'optimiser les auteurs r\xe9cents."}),"\n",(0,t.jsxs)(n.p,{children:["Pour la m\xe9thode ",(0,t.jsx)(n.strong,{children:"GenDateDeces()"}),",  il est plus pertinent pour la date de d\xe9c\xe8s d'avoir plus de logique. Il est impossible d'avoir un auteur de 200 ans. Il faut avoir des dates de d\xe9c\xe8s r\xe9aliste en fonction de la date de naissance. Pour cet outil, tous les auteurs qui ont plus de 95 ans doivent avoir une date de d\xe9c\xe8s. Il faut \xe9galement que l'auteur ait v\xe9cu un nombre d'ann\xe9es minimal. L'\xe2ge minimal est 15 ans."]}),"\n",(0,t.jsx)(n.p,{children:"Dans le cas que l'auteur a moins de 95 ans, il y a 5% de chance qu'il soit d\xe9c\xe9d\xe9. Il doit avoir au moins 14 ans \xe0 la date de son d\xe9c\xe8s."}),"\n",(0,t.jsx)(n.h3,{id:"test-2",children:"Test"}),"\n",(0,t.jsxs)(n.p,{children:["Modifiez le fichier ",(0,t.jsx)(n.strong,{children:"Program.cs"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using GenerateurBDGestionLivre;\r\nusing GenerateurBDGestionLivre.Data;\r\nusing GenerateurBDGestionLivre.Data.Context;\r\n\r\nusing (GestionLivreContext db = new GestionLivreContext())\r\n{\r\n    AuteurGenerateur generateur = new AuteurGenerateur();\r\n\r\n    for(int i = 0; i < 1000; i++)\r\n    {\r\n        Auteur auteur = generateur.Generer();        \r\n\r\n        Console.WriteLine($"Prenom : {auteur.Prenom}");\r\n        Console.WriteLine($"Nom : {auteur.Nom}");\r\n        Console.WriteLine($"Date naissance : {auteur.DateNaissance}");\r\n        Console.WriteLine($"Date d\xe9c\xe8s : {auteur.DateDeces}");\r\n        Console.WriteLine($"Biographie : {auteur.Biographie}");\r\n        Console.WriteLine();\r\n\r\n        //Ajoute dans la base de donn\xe9es\r\n        db.Add(auteur);\r\n        //Enregistre dans la base de donn\xe9es\r\n        db.SaveChanges();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Voici un exemple."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Prenom : Darryl\r\nNom : Satterfield\r\nDate naissance : 1938-09-16 00:00:00\r\nDate d\xe9c\xe8s :\r\nBiographie : Magni inventore est sequi cum suscipit omnis autem debitis perspiciatis. Non cumque enim modi nulla et. Quisquam quos sequi vel.\r\n\r\nQuisquam neque sed quidem. Voluptas asperiores blanditiis ratione exercitationem rerum sit fuga. Voluptatem quia voluptas fuga harum aut alias quod et. Et laboriosam delectus odit est eligendi itaque dolore.\r\n\r\nEos quidem minima enim. A et et sit sapiente dolor reiciendis et qui sit. Corporis animi voluptatem quia sequi nihil qui eum ipsa perferendis.\r\n\r\nPrenom : Linnea\r\nNom : Herzog\r\nDate naissance : 1950-08-30 00:00:00\r\nDate d\xe9c\xe8s : 2022-05-08 00:00:00\r\nBiographie : Qui molestiae aliquid qui dolores praesentium. Corporis repellendus iste quis. Voluptas sequi omnis illo in architecto deleniti voluptates dolor. Ut cupiditate sed.\r\n\r\nPrenom : Arnulfo\r\nNom : Ruecker\r\nDate naissance : 1826-04-24 00:00:00\r\nDate d\xe9c\xe8s : 1865-05-10 00:00:00\r\nBiographie :\n"})}),"\n",(0,t.jsx)(n.h2,{id:"table-livre",children:"Table Livre"}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Livre"})," contient l'information d'un livre."]}),"\n",(0,t.jsx)(n.p,{children:"La table a 2 cl\xe9s \xe9trang\xe8res. Il est important de ne pas pendre des nombres au hasard, mais des cl\xe9s \xe9trang\xe8res qui existent r\xe9ellement dans la base de donn\xe9es. Si la cl\xe9 \xe9trang\xe8re n'existe pas, l'enregistrement sera refus\xe9 dans la base de donn\xe9es."}),"\n",(0,t.jsxs)(n.p,{children:["Cr\xe9ez la classe ",(0,t.jsx)(n.strong,{children:"LivreGenerateur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using Bogus;\r\nusing GenerateurDBGestionLivre.Data;\r\n\r\nnamespace GenerateurBDGestionLivre;\r\n\r\npublic class LivreGenerateur : Faker<Livre>\r\n{\r\n    private List<int> _lstCollectionId = new List<int>();\r\n    private List<int> _lstEditeurId = new List<int>();\r\n\r\n    public LivreGenerateur()\r\n    {\r\n        RuleFor(i => i.Titre, GenTitre);\r\n        RuleFor(i => i.Resume, GenResume);\r\n        RuleFor(i => i.DatePublication, GenDatePublication);\r\n        RuleFor(i => i.Prix, GenPrix);\r\n        RuleFor(i => i.NbPage, GenNbPage);\r\n        RuleFor(i => i.Categorie, GenCategorie);\r\n        RuleFor(i => i.CollectionId, GenCollectionId);\r\n        RuleFor(i => i.EditeurId, GenEditeurId);\r\n    }\r\n\r\n    public Livre Generer()\r\n    {\r\n        return base.Generate();\r\n    }\r\n\r\n    public void AssignerListeCollectionId(List<int> lstCollectionId)\r\n    {\r\n        _lstCollectionId.Clear();\r\n        _lstCollectionId.AddRange(lstCollectionId);\r\n    }\r\n\r\n    public void AssignerListeEditeurId(List<int> lstEditeurId)\r\n    {\r\n        _lstEditeurId.Clear();\r\n        _lstEditeurId.AddRange(lstEditeurId);\r\n    }\r\n\r\n    private string GenTitre(Faker f)\r\n    {\r\n        //G\xe9n\xe8re une s\xe9rie de mots\r\n        //VARCHAR(100)\r\n        return f.Random.Words().Tronquer(100)!;\r\n    }\r\n\r\n    private string GenResume(Faker f)\r\n    {\r\n        //G\xe9n\xe8re entre 1 et 4 paragraphes\r\n        //VARCHAR(5000)\r\n        return f.Lorem.Paragraphs(1, 4).Tronquer(5000)!;\r\n    }\r\n\r\n    private DateOnly GenDatePublication(Faker f)\r\n    {\r\n        //Retourne une date dans les 25 derni\xe8res ann\xe9es\r\n        return f.Date.PastDateOnly(25);\r\n    }\r\n\r\n    private decimal GenPrix(Faker f)\r\n    {\r\n        //DECIMAL(5,2) => 0.00 et 999.99\r\n        return f.Finance.Amount(0, 999.99m);\r\n    }\r\n\r\n    private short GenNbPage(Faker f)\r\n    {\r\n        //G\xe9n\xe8re entre 20 et 5123 pages\r\n        //TINYINT\r\n        return f.Random.Short(20, 5123);\r\n    }\r\n\r\n    private string GenCategorie(Faker f)\r\n    {\r\n        //La liste des valeurs possibles dans la contrainte CHECK\r\n        string[] categories = { "Jeunesse", "Biographie", "Policier" };\r\n\r\n        //Selectionne une valeur dans la liste\r\n        return f.PickRandom(categories);\r\n    }\r\n\r\n    private int GenCollectionId(Faker f)\r\n    {\r\n        //S\xe9lectionne un EditeurId dans la liste des CollectionId disponibles\r\n        return f.PickRandom(_lstCollectionId);\r\n    }\r\n\r\n    private int GenEditeurId(Faker f)\r\n    {\r\n        //S\xe9lectionne un EditeurId dans la liste des EditeurId disponibles\r\n        return f.PickRandom(_lstEditeurId);\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"La classe a 2 attributs pour contenir les listes des cl\xe9s \xe9trang\xe8res."}),"\n",(0,t.jsx)(n.p,{children:"Elle a \xe9galement les 2 m\xe9thodes d'assignation des d\xe9pendances."}),"\n",(0,t.jsx)(n.p,{children:"Avant de d\xe9buter une g\xe9n\xe9ration, il est important que ces listes soient assign\xe9es. Toutes les tables qui utilisent des cl\xe9s \xe9trang\xe8res doivent avoir cette approche."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER"',children:"/***/\r\nprivate List<int> _lstCollectionId= new List<int>();\r\nprivate List<int> _lstEditeurId = new List<int>();\r\n\r\n/***/\r\npublic void AssignerListeCollectionId(List<int> lstCollectionId)\r\n{\r\n    _lstCollectionId.Clear();\r\n    _lstCollectionId.AddRange(lstCollectionId);\r\n}\r\n\r\npublic void AssignerListeEditeurId(List<int> lstEditeurId)\r\n{\r\n    _lstEditeurId.Clear();\r\n    _lstEditeurId.AddRange(lstEditeurId);\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Les m\xe9thodes ",(0,t.jsx)(n.strong,{children:"GenCollectionId()"})," et ",(0,t.jsx)(n.strong,{children:"GenEditeurId()"})," utilisent la fonctionnalit\xe9 ",(0,t.jsx)(n.strong,{children:"PickRandom()"})," de ",(0,t.jsx)(n.strong,{children:"Bogus"}),". Cette fonctionnalit\xe9 permet de choisir au hasard un item dans un tableau ou une collection."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER"',children:"private int GenCollectionId(Faker f)\r\n{\r\n    //S\xe9lectionne un EditeurId dans la liste des CollectionId disponibles\r\n    return f.PickRandom(_lstCollectionId);\r\n}\r\n\r\nprivate int GenEditeurId(Faker f)\r\n{\r\n    //S\xe9lectionne un EditeurId dans la liste des EditeurId disponibles\r\n    return f.PickRandom(_lstEditeurId);\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Une autre particularit\xe9 pour ce g\xe9n\xe9rateur est pour le champ ",(0,t.jsx)(n.strong,{children:"Categorie"}),". Ce champ a une contrainte ",(0,t.jsx)(n.strong,{children:"CHECK"})," et permet seulement 3 valeurs."]}),"\n",(0,t.jsxs)(n.p,{children:["Les 3 valeurs de la contrainte ",(0,t.jsx)(n.strong,{children:"CHECK"})," sont dans l'attribut ",(0,t.jsx)(n.strong,{children:"_categories"})," de la classe."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER"',children:'//La liste des valeurs possibles de la contrainte CK_Livre_Categorie\r\nprivate string[] _categories = { "Jeunesse", "Biographie", "Policier" };\r\n\r\n/***/\r\n\r\nprivate string GenCategorie(Faker f)\r\n{\r\n    //Selectionne une valeur dans la liste\r\n    return f.PickRandom(categories);\r\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Pour la propri\xe9t\xe9 ",(0,t.jsx)(n.strong,{children:"Prix"}),", le module ",(0,t.jsx)(n.strong,{children:"Finance"})," est utilis\xe9. Elle permet de g\xe9n\xe9rer des montants avec 2 d\xe9cimales."]}),"\n",(0,t.jsxs)(n.p,{children:["Il est important de respecter la pr\xe9cision du ",(0,t.jsx)(n.strong,{children:"DECIMAL SQL"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER"',children:"private decimal GenPrix(Faker f) \r\n{\r\n    //DECIMAL(5,2) => 0.00 et 999.99\r\n    return f.Finance.Amount(0, 999.99m);\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Pour la propri\xe9t\xe9 ",(0,t.jsx)(n.strong,{children:"DatePublication"}),", la m\xe9thode ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"Past()"})})," du module ",(0,t.jsx)(n.strong,{children:"Date"})," permet de g\xe9n\xe9rer une date dans le pass\xe9e."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:'title="NE PAS COPIER"',children:"private DateTime GenDatePublication(Faker f) \r\n{\r\n    //Retourne une date dans les 25 derni\xe8res ann\xe9e\r\n    return f.Date.Past(25).Date;\r\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Les autres m\xe9thodes de g\xe9n\xe9ration utilisent des concepts similaires des autres tables."}),"\n",(0,t.jsx)(n.h3,{id:"test-3",children:"Test"}),"\n",(0,t.jsxs)(n.p,{children:["Modifiez le fichier ",(0,t.jsx)(n.strong,{children:"Program.cs"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:"showLineNumbers",children:'using GenerateurBDGestionLivre;\r\nusing GenerateurBDGestionLivre.Data;\r\nusing GenerateurBDGestionLivre.Data.Context;\r\n\r\nusing (GestionLivreContext db = new GestionLivreContext())\r\n{\r\n    LivreGenerateur generateur = new LivreGenerateur();\r\n\r\n    //Obtenir la liste des cl\xe9s EditeurId dans la base de de donn\xe9es\r\n    List<int> lstEditeurId = db.Editeur.Select(e => e.EditeurId).ToList();\r\n    //Obtenir la liste des cl\xe9s CollectionId dans la base de de donn\xe9es\r\n    List<int> lstCollectionId = db.Collection.Select(c => c.CollectionId).ToList();\r\n    \r\n    //Assigner la liste dans le g\xe9n\xe9rateur\r\n    generateur.AssignerListeEditeurId(lstEditeurId);\r\n    //Assigner la liste dans le g\xe9n\xe9rateur    \r\n    generateur.AssignerListeCollectionId(lstCollectionId);\r\n\r\n    for (int i = 0; i < 5; i++)\r\n    {\r\n        Livre livre = generateur.Generer();        \r\n\r\n        Console.WriteLine($"Titre : {livre.Titre}");\r\n        Console.WriteLine($"R\xe9sum\xe9 : {livre.Resume}");\r\n        Console.WriteLine($"Date publication : {livre.DatePublication}");\r\n        Console.WriteLine($"Prix : {livre.Prix}");\r\n        Console.WriteLine($"Nombre de pages : {livre.NbPage}");\r\n        Console.WriteLine($"Cat\xe9gories : {livre.Categorie}");\r\n        Console.WriteLine($"CollectionId : {livre.CollectionId}");\r\n        Console.WriteLine($"EditeurId : {livre.EditeurId}");\r\n\r\n        Console.WriteLine();\r\n\r\n        //Ajoute dans la base de donn\xe9es\r\n        db.Add(livre);\r\n        //Enregistre dans la base de donn\xe9es\r\n        db.SaveChanges();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Les lignes 10 et 12 r\xe9cup\xe8rent de la base de donn\xe9es toutes les cl\xe9s disponibles pour chacune des tables parents."}),"\n",(0,t.jsx)(n.p,{children:"Les lignes 15 et 17 permettent d'ajouter les cl\xe9s \xe9trang\xe8res dans le g\xe9n\xe9rateur."}),"\n",(0,t.jsx)(n.p,{children:"Voici un exemple."}),"\n",(0,t.jsx)(n.p,{children:"Les prix sont assez \xe9lev\xe9s. Il serait plus r\xe9aliste de r\xe9duire la plage \xe0 moins de 50$, m\xeame si la base de donn\xe9es permet jusqu'\xe0 999.99."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Titre : Mobility\r\nR\xe9sum\xe9 : Sunt dolor corrupti hic. Et ipsa a omnis consequatur. Ipsa tempore officia quod voluptatem et laborum incidunt deleniti. Voluptatem consequatur quis doloremque nobis corporis maiores suscipit optio non. Ducimus consequatur debitis.\r\nDate publication : 2000-07-17 00:00:00\r\nPrix : 795,39\r\nNombre de pages : 3378\r\nCat\xe9gories : Jeunesse\r\nCollectionId : 11\r\nEditeurId : 14\r\n\r\nTitre : USB Money Market Account installation\r\nR\xe9sum\xe9 : Ut aut repudiandae placeat voluptatem fugiat eum. Nesciunt eveniet itaque nihil non quas neque natus qui deserunt. Officiis magnam et ut quaerat sunt sequi. Reprehenderit ad nemo possimus deserunt vitae consequatur aliquam. Veniam aut fugiat at eum quis corporis. Culpa nam laboriosam culpa quam eveniet quam quia autem voluptatum.\r\n\r\nVel deleniti et nesciunt eos et placeat repudiandae praesentium deleniti. Aut temporibus qui consequatur porro. Commodi sed itaque nesciunt est et doloribus at reprehenderit itaque. Totam reprehenderit et. Ut sint est rerum consequuntur id est totam. Debitis ut quasi.\r\n\r\nMollitia veritatis aut perferendis id aut sed nisi. Nostrum minus voluptatem. Deleniti enim voluptas sed recusandae enim ut nihil omnis iusto. Quod reiciendis dolorem ipsum. Beatae dolorum eius illum.\r\n\r\nFugiat sed et voluptatem nulla adipisci. Aut sed reiciendis modi voluptatum est enim. Autem et quo.\r\nDate publication : 2016-12-03 00:00:00\r\nPrix : 946,61\r\nNombre de pages : 562\r\nCat\xe9gories : Jeunesse\r\nCollectionId : 19\r\nEditeurId : 13\r\n\r\nTitre : Handcrafted Wooden Tasty Metal Table\r\nR\xe9sum\xe9 : Suscipit fugiat est beatae. Perferendis aut quas iste. Porro dolores qui consectetur alias sint laboriosam voluptatem voluptates. Nihil quis explicabo rerum aut et provident delectus ad. Adipisci velit sint et quidem quibusdam necessitatibus odit praesentium quo.\r\nDate publication : 2004-04-08 00:00:00\r\nPrix : 707,16\r\nNombre de pages : 1652\r\nCat\xe9gories : Jeunesse\r\nCollectionId : 2\r\nEditeurId : 5\n"})}),"\n",(0,t.jsx)(n.h2,{id:"la-table-livreauteur",children:"La table LivreAuteur"}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"LivreAuteur"})," est une table pivot. Elle permet d'indiquer les auteurs d'un livre."]}),"\n",(0,t.jsxs)(n.p,{children:["Au niveau du ",(0,t.jsx)(n.strong,{children:"contexte"}),", il n'y a pas de classe, car il s'agit d'une table pivot ",(0,t.jsx)(n.strong,{children:'"pure"'}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Pour \xeatre en mesure de cr\xe9er des enregistrements dans une table pivot ",(0,t.jsx)(n.strong,{children:'"pure"'}),", il faut l'ajouter \xe0 partir d'une des tables parents."]}),"\n",(0,t.jsxs)(n.p,{children:["Donc, pour ",(0,t.jsx)(n.strong,{children:"LivreAuteur"}),", ce sont les classes ",(0,t.jsx)(n.strong,{children:"Livre"})," et ",(0,t.jsx)(n.strong,{children:"Auteur"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Dans la classe ",(0,t.jsx)(n.strong,{children:"Livre"}),", il y a une collection de type ",(0,t.jsx)(n.strong,{children:"Auteur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public virtual ICollection<Auteur> Auteur { get; } = new List<Auteur>();\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Dans la classe ",(0,t.jsx)(n.strong,{children:"Auteur"}),", il y a une collection de type ",(0,t.jsx)(n.strong,{children:"Livre"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public virtual ICollection<Livre> Livre { get; } = new List<Livre>();\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Dans la classe ",(0,t.jsx)(n.strong,{children:"GestionLivreContext"}),",  dans la m\xe9thode ",(0,t.jsx)(n.strong,{children:"onModelCreating()"}),", il y a l'explication de la table ",(0,t.jsx)(n.strong,{children:"LivreAuteur"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Il n'est pas n\xe9cessaire de comprendre \xe0 cette \xe9tape la relation, mais ",(0,t.jsx)(n.strong,{children:"Entity"})," est en mesure de cr\xe9er les enregistrements dans la table ",(0,t.jsx)(n.strong,{children:"LivreAuteur"})," \xe0 partir des propri\xe9t\xe9s de navigation."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'modelBuilder.Entity<Livre>(entity =>\r\n{\r\n    /***/\r\n\r\n    entity.HasMany(d => d.Auteur).WithMany(p => p.Livre)\r\n        .UsingEntity<Dictionary<string, object>>(\r\n            "LivreAuteur",\r\n            r => r.HasOne<Auteur>().WithMany()\r\n                .HasForeignKey("AuteurId")\r\n                .OnDelete(DeleteBehavior.ClientSetNull)\r\n                .HasConstraintName("FK_LivreAuteur_AuteurId"),\r\n            l => l.HasOne<Livre>().WithMany()\r\n                .HasForeignKey("LivreId")\r\n                .OnDelete(DeleteBehavior.ClientSetNull)\r\n                .HasConstraintName("FK_LivreAuteur_LivreId"),\r\n            j =>\r\n            {\r\n                j.HasKey("LivreId", "AuteurId");\r\n                    });\r\n        });\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Donc pour g\xe9n\xe9rer des donn\xe9es, il faut le faire \xe0 partir des g\xe9n\xe9rateurs  ",(0,t.jsx)(n.strong,{children:"AuteurGenerateur"})," ou ",(0,t.jsx)(n.strong,{children:"LivreGenerateur"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Pour cet exemple, le g\xe9n\xe9rateur ",(0,t.jsx)(n.strong,{children:"LivreGenerateur"})," sera utilis\xe9."]}),"\n",(0,t.jsx)(n.h3,{id:"modification-de-livregenerateur",children:"Modification de LivreGenerateur"}),"\n",(0,t.jsxs)(n.p,{children:["Voici la nouvelle classe ",(0,t.jsx)(n.strong,{children:"LivreGenerateur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"using Bogus;\r\nusing GenerateurBDGestionLivre.Data;\r\n\r\nnamespace GenerateurBDGestionLivre;\r\n\r\npublic class LivreGenerateur : Faker<Livre>\r\n{\r\n    private List<int> _lstCollectionId= new List<int>();\r\n    private List<int> _lstEditeurId = new List<int>();\r\n    //highlight-next-line\r\n    private List<Auteur> _lstAuteur = new List<Auteur>();\r\n\r\n//highlight-start\r\n    //La liste des valeurs possibles de la contrainte CK_Livre_Categorie\r\n    private string[] _categories = { \"Jeunesse\", \"Biographie\", \"Policier\" };\r\n//highlight-end\r\n\r\n    public LivreGenerateur()\r\n    {\r\n        RuleFor(i => i.Titre, GenTitre);\r\n        RuleFor(i => i.Resume, GenResume);\r\n        RuleFor(i => i.DatePublication, GenDatePublication);\r\n        RuleFor(i => i.Prix, GenPrix);\r\n        RuleFor(i => i.NbPage, GenNbPage);\r\n        RuleFor(i => i.Categorie, GenCategorie);\r\n        RuleFor(i => i.CollectionId, GenCollectionId);\r\n        RuleFor(i => i.EditeurId, GenEditeurId);\r\n    }\r\n\r\n    public Livre Generer()\r\n    {\r\n        //highlight-start\r\n        Livre livre =  base.Generate();\r\n        GenAuteurs(livre);\r\n        return livre;\r\n        //highlight-end\r\n    }\r\n\r\n    public void AssignerListeCollectionId(List<int> lstCollectionId)\r\n    {\r\n        _lstCollectionId.Clear();\r\n        _lstCollectionId.AddRange(lstCollectionId);\r\n    }\r\n\r\n    public void AssignerListeEditeurId(List<int> lstEditeurId)\r\n    {\r\n        _lstEditeurId.Clear();\r\n        _lstEditeurId.AddRange(lstEditeurId);\r\n    }\r\n\r\n//highlight-start\r\n    public void AssignerListeAuteur(List<Auteur> lstAuteur)\r\n    {\r\n        //Ce n'est pas des Id, mais une liste des enregistrements Auteur.\r\n        _lstAuteur.Clear();\r\n        _lstAuteur.AddRange(lstAuteur);\r\n    }\r\n    //highlight-end\r\n\r\n    private string GenTitre(Faker f)\r\n    {\r\n        //G\xe9n\xe8re une s\xe9rie de mots\r\n        //VARCHAR(100)\r\n        return f.Random.Words().Tronquer(100)!;\r\n    }\r\n\r\n    private string GenResume(Faker f)\r\n    {\r\n        //G\xe9n\xe8re entre 1 et 4 paragraphes\r\n        //VARCHAR(5000)\r\n        return f.Lorem.Paragraphs(1, 4).Tronquer(5000)!;\r\n    }\r\n\r\n   private DateOnly GenDatePublication(Faker f)\r\n    {\r\n        //Retourne une date dans les 25 derni\xe8res ann\xe9es\r\n        return f.Date.PastDateOnly(25);\r\n    }\r\n\r\n    private decimal GenPrix(Faker f) \r\n    {\r\n        //DECIMAL(5,2) => 0.00 et 999.99\r\n        return f.Finance.Amount(0, 999.99m);\r\n    }\r\n\r\n    private short GenNbPage(Faker f) \r\n    {\r\n        //G\xe9n\xe8re entre 20 et 5123 pages\r\n        //TINYINT\r\n        return f.Random.Short(20, 5123);\r\n    }\r\n\r\n    private string GenCategorie(Faker f)\r\n    {\r\n        //Selectionne une valeur dans la liste\r\n        //highlight-next-line\r\n        return f.PickRandom(_categories);\r\n    }\r\n\r\n    private int GenCollectionId(Faker f)\r\n    {\r\n        //S\xe9lectionne un EditeurId dans la liste des CollectionId disponibles\r\n        return f.PickRandom(_lstCollectionId);\r\n    }\r\n\r\n    private int GenEditeurId(Faker f)\r\n    {\r\n        //S\xe9lectionne un EditeurId dans la liste des EditeurId disponibles\r\n        return f.PickRandom(_lstEditeurId);\r\n    }\r\n\r\n//highlight-start\r\n    private void GenAuteurs(Livre livre)\r\n    {\r\n        //V\xe9rifie si la liste d'auteur n'est pas vide\r\n        if (_lstAuteur.Count > 0)\r\n        {\r\n            //La liste d'auteur n'est pas vide\r\n\r\n            //Cr\xe9er un Faker pour avoir un g\xe9n\xe9rateur de nombre\r\n            Faker f = new Faker();\r\n            //Permet de choisir entre 1 et 3 auteurs. S'il y a moins que 3 auteurs, le nombre maximum sera le nombre d'auteurs.\r\n            int nbAuteur = f.Random.Number(1, Math.Min(_lstAuteur.Count, 3));\r\n            \r\n            //Le code ci-dessous permet de s'assurer que le m\xeame auteur n'est pas pig\xe9 plusieurs fois.\r\n            do\r\n            {\r\n                Auteur auteurSelectionne = f.PickRandom(_lstAuteur);\r\n\r\n                if (livre.Auteur.Contains(auteurSelectionne) == false)\r\n                {\r\n                    //L'auteur s\xe9lectionn\xe9 est un nouvel auteur                \r\n                    livre.Auteur.Add(auteurSelectionne);\r\n                    nbAuteur--;\r\n                }\r\n\r\n            } while (nbAuteur > 0);            \r\n        }\r\n    }\r\n    //highlight-end\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Il y a maintenant un attribut ",(0,t.jsx)(n.strong,{children:"List<Auteur> _lstAuteur"})," qui contient les auteurs disponibles et sa m\xe9thode d'assignation."]}),"\n",(0,t.jsxs)(n.p,{children:["Dans ce cas, il est important que ce soit l'objet ",(0,t.jsx)(n.strong,{children:"Auteur"})," et non seulement les ",(0,t.jsx)(n.strong,{children:"Id"}),", car ",(0,t.jsx)(n.strong,{children:"Entity Framework"})," ne peut pas ajouter directement des enregistrements \xe0 partir de la cl\xe9, mais \xe0 partir de l'objet."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"private List<Auteur> _lstAuteur = new List<Auteur>();\r\n\r\n/***/\r\npublic void AssignerListeAuteur(List<Auteur> lstAuteur)\r\n{\r\n    //Ce n'est pas des Id, mais une liste des enregistrements Auteur.\r\n    _lstAuteur.Clear();\r\n    _lstAuteur.AddRange(lstAuteur);\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Ensuite, il y a la m\xe9thode ",(0,t.jsx)(n.strong,{children:"GenAuteurs()"})," qui permet de choisir la liste des auteurs de ce livre."]}),"\n",(0,t.jsxs)(n.p,{children:["La m\xe9thode re\xe7oit en param\xe8tre l'objet ",(0,t.jsx)(n.strong,{children:"Livre"})," en cours de g\xe9n\xe9ration."]}),"\n",(0,t.jsx)(n.p,{children:"\xc0 la ligne 11, le nombre d'auteurs pour ce livre est choisi au hasard. Il serait int\xe9ressant de favoriser 1 auteur seulement par rapport \xe0 2 ou 3. Mais pour simplifier, chaque nombre aura la m\xeame probabilit\xe9."}),"\n",(0,t.jsxs)(n.p,{children:["Il y a une protection pour \xe9viter de s\xe9lectionner 2 fois le m\xeame auteur. La m\xe9thode ",(0,t.jsx)(n.strong,{children:"PickRandom()"})," peut choisir le m\xeame \xe9l\xe9ment plus d'une fois. Entre les lignes 14 et 25, c'est la boucle de s\xe9lection. La v\xe9rification se fait \xe0 la ligne 18."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:"showLineNumbers",children:"private void GenAuteurs(Livre livre)\r\n{\r\n    //V\xe9rifie si la liste d'auteur n'est pas vide\r\n    if (_lstAuteur.Count > 0)\r\n    {\r\n        //La liste d'auteur n'est pas vide\r\n\r\n        //Cr\xe9er un Faker pour avoir un g\xe9n\xe9rateur de nombre\r\n        Faker f = new Faker();\r\n        //Permet de choisir entre 1 et 3 auteurs. S'il y a moins que 3 auteurs, le nombre maximum sera le nombre d'auteurs.\r\n        int nbAuteur = f.Random.Number(1, Math.Min(_lstAuteur.Count, 3));\r\n        \r\n        //Le code ci-dessous permet de s'assurer que le m\xeame auteur n'est pas pig\xe9 plusieurs fois.\r\n        do\r\n        {\r\n            Auteur auteurSelectionne = f.PickRandom(_lstAuteur);\r\n\r\n            if (livre.Auteur.Contains(auteurSelectionne) == false)\r\n            {\r\n                //L'auteur s\xe9lectionn\xe9 est un nouvel auteur                \r\n                livre.Auteur.Add(auteurSelectionne);\r\n                nbAuteur--;\r\n            }\r\n\r\n        } while (nbAuteur > 0);            \r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["La m\xe9thode ",(0,t.jsx)(n.strong,{children:"Generer()"})," est modifi\xe9e. Il n'est pas possible de mettre dans le constructeur une r\xe8gle ",(0,t.jsx)(n.strong,{children:"RuleFor"})," pour l'ajout dans une collection. La m\xe9thode ",(0,t.jsx)(n.strong,{children:"RuleFor"})," permet de faire des assignations uniquement."]}),"\n",(0,t.jsxs)(n.p,{children:["Il faut donc g\xe9n\xe9rer un objet ",(0,t.jsx)(n.strong,{children:"Livre"})," et ensuite ajouter les auteurs avant de le retourner."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public Livre Generer()\r\n{\r\n    //G\xe9n\xe8re un livre\r\n    Livre livre =  base.Generate();\r\n\r\n    //Assigne des auteurs\r\n    GenAuteurs(livre);\r\n\r\n    //Retourne l'objet livre complet\r\n    return livre;\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"test-4",children:"Test"}),"\n",(0,t.jsx)(n.admonition,{title:"Attention",type:"warning",children:(0,t.jsx)(n.p,{children:"Avant d'ex\xe9cuter ce code, vider la table Livre"})}),"\n",(0,t.jsxs)(n.p,{children:["Modifiez le fichier ",(0,t.jsx)(n.strong,{children:"Program.cs"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using GenerateurBDGestionLivre;\r\nusing GenerateurBDGestionLivre.Data;\r\nusing GenerateurBDGestionLivre.Data.Context;\r\n\r\nusing (GestionLivreContext db = new GestionLivreContext())\r\n{\r\n    LivreGenerateur generateur = new LivreGenerateur();\r\n\r\n    //Obtenir la liste des cl\xe9s EditeurId dans la base de de donn\xe9es\r\n    List<int> lstEditeurId = db.Editeur.Select(e => e.EditeurId).ToList();\r\n    //Assigner la liste dans le g\xe9n\xe9rateur\r\n    generateur.AssignerListeEditeurId(lstEditeurId);\r\n\r\n    //Obtenir la liste des cl\xe9s CollectionId dans la base de de donn\xe9es\r\n    List<int> lstCollectionId = db.Collection.Select(c => c.CollectionId).ToList();\r\n    //Assigner la liste dans le g\xe9n\xe9rateur    \r\n    generateur.AssignerListeCollectionId(lstCollectionId);\r\n\r\n    //Obtenir la liste des auteurs\r\n    List<Auteur> lstAuteur = db.Auteur.ToList();\r\n    //Assigner la liste dans le g\xe9n\xe9rateur    \r\n    generateur.AssignerListeAuteur(lstAuteur);\r\n\r\n\r\n    for (int i = 0; i < 5; i++)\r\n    {\r\n        Livre livre = generateur.Generer();        \r\n\r\n        Console.WriteLine($"Titre : {livre.Titre}");\r\n        Console.WriteLine($"R\xe9sum\xe9 : {livre.Resume}");\r\n        Console.WriteLine($"Date publication : {livre.DatePublication}");\r\n        Console.WriteLine($"Prix : {livre.Prix}");\r\n        Console.WriteLine($"Nombre de pages : {livre.NbPage}");\r\n        Console.WriteLine($"Cat\xe9gories : {livre.Categorie}");\r\n        Console.WriteLine($"CollectionId : {livre.CollectionId}");\r\n        Console.WriteLine($"EditeurId : {livre.EditeurId}");\r\n\r\n        Console.WriteLine();\r\n\r\n        //Ajoute dans la base de donn\xe9es\r\n        db.Add(livre);\r\n        //Enregistre dans la base de donn\xe9es\r\n        db.SaveChanges();\r\n    }\r\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Dans ",(0,t.jsx)(n.strong,{children:"SSMS"}),", effectuez cette requ\xeate. Vous devriez voir des enregistrements."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM LivreAuteur;\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Le g\xe9n\xe9rateur peut g\xe9n\xe9rer des livres apr\xe8s la mort d'un auteur. Ce n'est pas tr\xe8s logique. Il serait possible de r\xe9gler ce probl\xe8me, mais le g\xe9n\xe9rateur serait un peu plus complexe. Il faudrait faire de la v\xe9rification intertable."})}),"\n",(0,t.jsx)(n.h2,{id:"table-magasin-et-inventaire",children:"Table Magasin et Inventaire"}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Inventaire"})," est une table pivot entre ",(0,t.jsx)(n.strong,{children:"Magasin"})," et ",(0,t.jsx)(n.strong,{children:"Livre"}),", mais elle a une propri\xe9t\xe9 ",(0,t.jsx)(n.strong,{children:"Quantite"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["La classe ",(0,t.jsx)(n.strong,{children:"Inventaire"})," existe dans le ",(0,t.jsx)(n.strong,{children:"contexte"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Il serait possible de g\xe9n\xe9rer ",(0,t.jsx)(n.strong,{children:"Inventaire"})," en recevant la liste de ",(0,t.jsx)(n.strong,{children:"MagasinId"})," et de ",(0,t.jsx)(n.strong,{children:"LivreId"}),". Par contre, il serait possible que le couple ",(0,t.jsx)(n.strong,{children:"MagasinId, LivreId"})," soit g\xe9n\xe9r\xe9 au hasard plus d'une fois. Donc l'enregistrement serait refus\xe9 par la base de donn\xe9es."]}),"\n",(0,t.jsxs)(n.p,{children:["Il faut donc g\xe9n\xe9rer ",(0,t.jsx)(n.strong,{children:"Inventaire"})," \xe0 partir de ",(0,t.jsx)(n.strong,{children:"Magasin"})," ou de ",(0,t.jsx)(n.strong,{children:"Livre"}),". \xc9tant donn\xe9 que ",(0,t.jsx)(n.strong,{children:"Livre"})," s'occupe des auteurs, ce sera ",(0,t.jsx)(n.strong,{children:"Magasin"})," qui s'en occupera pour cet exemple."]}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Inventaire"})," a ses propres champs. Il faut donc cr\xe9er une classe ",(0,t.jsx)(n.strong,{children:"InventaireGenerateur"})," \xe9galement."]}),"\n",(0,t.jsx)(n.h3,{id:"magagingenerateur",children:"MagaginGenerateur"}),"\n",(0,t.jsx)(n.p,{children:"La table poss\xe8de 4 champs."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Nom"})}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Company"})," permet de g\xe9n\xe9rer un nom de compagnie."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Adresse"})}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Adresse"})," permet de g\xe9n\xe9rer une adresse pour une rue."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Ville"})}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Adresse"})," permet de g\xe9n\xe9rer un nom de ville."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"CodePostal"})}),"\n",(0,t.jsxs)(n.p,{children:["Le module ",(0,t.jsx)(n.strong,{children:"Adresse"})," permet de g\xe9n\xe9rer un code postal selon un format."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Cr\xe9ez la classe ",(0,t.jsx)(n.strong,{children:"MagasinGenerateur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using Bogus;\r\nusing GenerateurBDGestionLivre.Data;\r\n\r\nnamespace GenerateurBDGestionLivre;\r\n\r\npublic class MagasinGenerateur : Faker<Magasin>\r\n{\r\n\tpublic MagasinGenerateur()\r\n\t{\r\n\t\tRuleFor(i => i.Nom, GenNom);\r\n        RuleFor(i => i.Adresse, GenAdresse);\r\n        RuleFor(i => i.Ville, GenVille);\r\n        RuleFor(i => i.CodePostal, GenPostalCode);\r\n    }\r\n\r\n\tpublic Magasin Generer()\r\n\t{\r\n\t\treturn base.Generate();\r\n\t}\r\n\r\n\tprivate string GenNom(Faker f)\r\n\t{\r\n        //VARCHAR(150)\r\n        return f.Company.CompanyName().Tronquer(150)!;\r\n\t}\r\n\r\n\tprivate string GenAdresse(Faker f)\r\n\t{\r\n\t\t//VARCHAR(100)\r\n\t\treturn f.Address.StreetAddress().Tronquer(100)!;\r\n\t}\r\n\r\n\tprivate string GenVille(Faker f)\r\n\t{\r\n\t\t//VARCAHR(100)\r\n\t\treturn f.Address.City().Tronquer(100)!;\r\n\t}\r\n\r\n\tprivate string GenPostalCode(Faker f)\r\n\t{\r\n\t\t//Format A0A 0A0\r\n\t\t//? = Lettre\r\n\t\t//# = Chiffre\r\n\t\treturn f.Address.ZipCode("?#? #?#");\r\n\t}\r\n\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"inventairegenerateur",children:"InventaireGenerateur"}),"\n",(0,t.jsxs)(n.p,{children:["La table ",(0,t.jsx)(n.strong,{children:"Inventaire"})," poss\xe8de 3 champs."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"LivreId"})}),"\n",(0,t.jsx)(n.p,{children:"La cl\xe9 \xe9trang\xe8re sera s\xe9lectionn\xe9e \xe0 partir des cl\xe9s qui auront \xe9t\xe9 assign\xe9es au g\xe9n\xe9rateur."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"MagasinId"})}),"\n",(0,t.jsxs)(n.p,{children:["La r\xe9f\xe9rence avec la table ",(0,t.jsx)(n.strong,{children:"Magasin"})," se fera par la propri\xe9t\xe9 de navigation. Le g\xe9n\xe9rateur s'occupera de g\xe9n\xe9rer les inventaires pour un magasin."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Quantite"})}),"\n",(0,t.jsx)(n.p,{children:"Un g\xe9n\xe9rateur de nombre permettra de cr\xe9er une quantit\xe9."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Cr\xe9ez la classe ",(0,t.jsx)(n.strong,{children:"InventaireGenerateur"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"using Bogus;\r\nusing GenerateurBDGestionLivre.Data;\r\n\r\nnamespace GenerateurBDGestionLivre;\r\n\r\npublic class InventaireGenerateur : Faker<Inventaire>\r\n{\r\n\tprivate List<int> _lstLivreId = new List<int>();\r\n\r\n\tpublic InventaireGenerateur()\r\n\t{\r\n        RuleFor(i => i.Quantite, GenQuantite);\r\n        RuleFor(i => i.LivreId, GenLivreId);\r\n\t}\r\n\r\n    public void Generer(Magasin magasin, int min, int max)\r\n    {\r\n        Faker f = new Faker();\r\n\r\n        //D\xe9termine le nombre d'inventaires \xe0 g\xe9n\xe9rer pour ce magasin\r\n        int nbInventaire = f.Random.Number(min, max);\r\n\r\n        //Le code ci-dessous permet de s'assurer que le m\xeame LivreId n'est pas pig\xe9 plusieurs fois.\r\n        List<int> lstLivreIdUtilise = new List<int>();\r\n        do\r\n        {\r\n            Inventaire inventaire = base.Generate();\r\n\r\n            //V\xe9rifie s'il y a un inventaire pour ce magasin qui a d\xe9j\xe0 ce livre\r\n            if (magasin.Inventaire.Count(i => i.LivreId == inventaire.LivreId) == 0)\r\n            {\r\n                //Le livre n'a jamais \xe9t\xe9 utilis\xe9 pour un inventaire de ce magasin\r\n                //L'inventaire est ajout\xe9 \xe0 la base de donn\xe9es, en assignant le MagasinId du magasin en cours\r\n                magasin.Inventaire.Add(inventaire);\r\n\r\n                nbInventaire--;\r\n            }\r\n\r\n        } while (nbInventaire > 0);\r\n    }\r\n\r\n    public void AssignerListeLivreId(List<int> lstLivreId)\r\n    {\r\n        _lstLivreId.Clear();\r\n        _lstLivreId.AddRange(lstLivreId);\r\n    }\r\n\r\n    private short GenQuantite(Faker f)\r\n    {\r\n        return f.Random.Short(0, 453);\r\n    }\r\n\r\n    private int GenLivreId(Faker f)\r\n    {\r\n        return f.PickRandom(_lstLivreId);\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"En gros, il s'agit d'un g\xe9n\xe9rateur comme les autres avec une assignation de d\xe9pendances."}),"\n",(0,t.jsxs)(n.p,{children:["Par contre, la m\xe9thode ",(0,t.jsx)(n.strong,{children:"Generer()"})," est diff\xe9rente."]}),"\n",(0,t.jsxs)(n.p,{children:["La m\xe9thode re\xe7oit en param\xe8tre un ",(0,t.jsx)(n.strong,{children:"Magasin"}),", une quantit\xe9 minimum et maximum \xe0 g\xe9n\xe9rer."]}),"\n",(0,t.jsx)(n.p,{children:"Les inventaires sont cr\xe9\xe9s en s\xe9lectionnant un livre dans la liste des cl\xe9s disponibles et en cr\xe9ant une quantit\xe9."}),"\n",(0,t.jsx)(n.p,{children:"Avant d'ajouter l'inventaire \xe0 la liste des inventaires de ce magasin, il faut s'assurer que le livre en question n'est pas d\xe9j\xe0 dans un inventaire du magasin."}),"\n",(0,t.jsxs)(n.p,{children:["L'inventaire est ajout\xe9 \xe0 la collection ",(0,t.jsx)(n.strong,{children:"Inventaire"})," de l'objet ",(0,t.jsx)(n.strong,{children:"Magasin"}),". Cette \xe9tape permet d'assigner le champ ",(0,t.jsx)(n.strong,{children:"MagasinId"})," \xe0 l'enregistrement ",(0,t.jsx)(n.strong,{children:"Inventaire"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"test-5",children:"Test"}),"\n",(0,t.jsxs)(n.p,{children:["La m\xe9canique est diff\xe9rente pour le ",(0,t.jsx)(n.strong,{children:"Program.cs"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",metastring:"showLineNumbers",children:'using GenerateurBDGestionLivre;\r\nusing GenerateurBDGestionLivre.Data;\r\nusing GenerateurBDGestionLivre.Data.Context;\r\n\r\nusing (GestionLivreContext db = new GestionLivreContext())\r\n{\r\n    MagasinGenerateur magasinGenerateur = new MagasinGenerateur();\r\n    \r\n    //Obtenir la liste des cl\xe9s EditeurId dans la base de de donn\xe9es\r\n    List<int> lstLivreId = db.Livre.Select(l => l.LivreId).ToList();\r\n\r\n    InventaireGenerateur inventaireGenerateur = new InventaireGenerateur();\r\n    inventaireGenerateur.AssignerListeLivreId(lstLivreId);\r\n\r\n\r\n    for (int i = 0; i < 50; i++)\r\n    {\r\n        //G\xe9n\xe8re un magasin\r\n        Magasin magasin = magasinGenerateur.Generer();\r\n\r\n        //G\xe9n\xe8re les inventaires pour ce magasin\r\n        //Il peut avoir entre 1 et tous les livres en inventaire pour ce magasin.\r\n        inventaireGenerateur.Generer(magasin, 1, lstLivreId.Count);\r\n\r\n        Console.WriteLine($"Nom : {magasin.Nom}");\r\n        Console.WriteLine($"Adresse : {magasin.Adresse}");\r\n        Console.WriteLine($"Ville : {magasin.Ville}");\r\n        Console.WriteLine($"Code Postal : {magasin.CodePostal}");\r\n\r\n        Console.WriteLine();\r\n\r\n        //Ajoute dans la base de donn\xe9es\r\n        //Les inventaires associ\xe9s \xe0 ce magasin seront \xe9galement ajout\xe9s\r\n        db.Add(magasin);\r\n        //Enregistre dans la base de donn\xe9es\r\n        db.SaveChanges();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Il faut cr\xe9er les 2 g\xe9n\xe9rateurs."}),"\n",(0,t.jsxs)(n.p,{children:["Dans le g\xe9n\xe9rateur ",(0,t.jsx)(n.strong,{children:"InventaireGenerateur"}),", il faut assigner la liste des livres qui existent d\xe9j\xe0 dans la base de donn\xe9es."]}),"\n",(0,t.jsxs)(n.p,{children:["\xc0 la ligne 19, un magasin est g\xe9n\xe9r\xe9 \xe0 partir du g\xe9n\xe9rateur ",(0,t.jsx)(n.strong,{children:"MagasinGenerateur"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Ensuite, \xe0 la ligne 23, les inventaires pour ce magasin sont g\xe9n\xe9r\xe9s."}),"\n",(0,t.jsxs)(n.p,{children:["Finalement, aux lignes 34 et 36, le magasin est ajout\xe9 dans le contexte et ensuite enregistr\xe9 dans la base de donn\xe9es. Les inventaires qui ont \xe9t\xe9 ajout\xe9s dans la propri\xe9t\xe9 ",(0,t.jsx)(n.strong,{children:"Magasin.Inventaire"})," sont \xe9galement ajout\xe9s. ",(0,t.jsx)(n.strong,{children:"Entity Framework"})," est en mesure d'assigner le ",(0,t.jsx)(n.strong,{children:"MagasinId"})," autog\xe9r\xe9n\xe9 \xe0 tous les enregistrements de la table ",(0,t.jsx)(n.strong,{children:"Inventaire"}),"."]})]})}function c(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>l,a:()=>a});var t=r(7294);const i={},s=t.createContext(i);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);