<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-WPF partie 1/injection_dependance" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Injection de dépendances | Notes de cours 4N1 2024</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/4N1_2024/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/4N1_2024/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/4N1_2024/docs/WPF partie 1/injection_dependance"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Injection de dépendances | Notes de cours 4N1 2024"><meta data-rh="true" name="description" content="Avant d&#x27;introduire la prochaine section, nous devons introduire l&#x27;injection de dépendances"><meta data-rh="true" property="og:description" content="Avant d&#x27;introduire la prochaine section, nous devons introduire l&#x27;injection de dépendances"><link data-rh="true" rel="icon" href="/4N1_2024/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/4N1_2024/docs/WPF partie 1/injection_dependance"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/4N1_2024/docs/WPF partie 1/injection_dependance" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/4N1_2024/docs/WPF partie 1/injection_dependance" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/4N1_2024/blog/rss.xml" title="Notes de cours 4N1 2024 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/4N1_2024/blog/atom.xml" title="Notes de cours 4N1 2024 Atom Feed"><link rel="stylesheet" href="/4N1_2024/assets/css/styles.6bcea008.css">
<script src="/4N1_2024/assets/js/runtime~main.6c60ae15.js" defer="defer"></script>
<script src="/4N1_2024/assets/js/main.45cd9819.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/4N1_2024/"><div class="navbar__logo"><img src="/4N1_2024/img/logo420.svg" alt="Cégep de Drummondville" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/4N1_2024/img/logo420.svg" alt="Cégep de Drummondville" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">4n1 Native III</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/4N1_2024/docs/TP3/tp3_description">Notes de cours</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/TP3/tp3_description">TP3</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Preparation/preparation_environnement">Preparation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Intro Csharp/Introduction_CSharp">Intro Csharp</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Révision SQL/introduction_SQL_Server">Révision SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/LINQ/app_sans_main">LINQ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Entity Framework/solid">Entity Framework</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Entity Framework 2/EF_navigation">Entity Framework 2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Génération de données de test/Bogus_intro">Génération de données de test</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/4N1_2024/docs/WPF partie 1/wpf_introduction">WPF partie 1</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4N1_2024/docs/WPF partie 1/wpf_introduction">WPF Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4N1_2024/docs/WPF partie 1/wpf_partie1_source">Code Partie 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4N1_2024/docs/WPF partie 1/supercarte_DEA">SuperCarte DEA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4N1_2024/docs/WPF partie 1/supercarte_ef">SuperCarte.EF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4N1_2024/docs/WPF partie 1/injection_dependance">Injection de dépendances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4N1_2024/docs/WPF partie 1/supercarte_core">SuperCarte.Core</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4N1_2024/docs/WPF partie 1/supercarte_wpf">SuperCarte.WPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4N1_2024/docs/WPF partie 1/wpf_resume">Résumé du code</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/WPF partie 2/intro_xaml">WPF partie 2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/WPF partie 3/wpf_partie3_source">WPF partie 3</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/WPF partie 4/introduction">WPF partie 4</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Tests Unitaires/tests_unitaire_integration_source">Tests Unitaires</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Tests intégration/introduction">Tests intégration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4N1_2024/docs/Enseignant/a_planning">Enseignant</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/4N1_2024/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">WPF partie 1</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Injection de dépendances</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Injection de dépendances</h1>
<p>Avant d&#x27;introduire la prochaine section, nous devons introduire l&#x27;injection de dépendances</p>
<p><a href="https://learn.microsoft.com/fr-fr/dotnet/architecture/modern-web-apps-azure/architectural-principles#dependency-inversion" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/fr-fr/dotnet/architecture/modern-web-apps-azure/architectural-principles#dependency-inversion</a></p>
<p><a href="https://learn.microsoft.com/fr-fr/dotnet/core/extensions/dependency-injection" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/fr-fr/dotnet/core/extensions/dependency-injection</a></p>
<p><a href="https://youtu.be/Hhpq7oYcpGE?si=uyluJ3V_JQtpRzX8" target="_blank" rel="noopener noreferrer">https://youtu.be/Hhpq7oYcpGE?si=uyluJ3V_JQtpRzX8</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="définition">Définition<a href="#définition" class="hash-link" aria-label="Direct link to Définition" title="Direct link to Définition">​</a></h2>
<p>L’injection de dépendances consiste, pour une classe, à déléguer la création de ses dépendances au code appelant qui va ensuite les injecter dans la classe correspondante. De ce fait, la création d’une instance de la dépendance est effectuée à l’extérieur de la classe dépendante et injectée dans la classe (le plus souvent dans le constructeur mais il existe d’autres possibilités). <a href="https://www.softfluent.fr/blog/injection-de-dependances-a-quoi-ca-sert/#:~:text=L&#x27;injection%20de%20d%C3%A9pendances%20consiste,injecter%20dans%20la%20classe%20correspondante." target="_blank" rel="noopener noreferrer">source</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quest-ce-quune-dépendance-">Qu&#x27;est-ce qu&#x27;une dépendance ?<a href="#quest-ce-quune-dépendance-" class="hash-link" aria-label="Direct link to Qu&#x27;est-ce qu&#x27;une dépendance ?" title="Direct link to Qu&#x27;est-ce qu&#x27;une dépendance ?">​</a></h2>
<p>Lorsqu&#x27;une fonction dans la classe A fait un new() d&#x27;un objet d&#x27;une clases B, la classe A devient <em>dépendante</em> de la classe B. Si, par exemple, on veut utiliser la classe A dans un autre projet, on doit obligatoirement introduire la classe B dans ce projet aussi.</p>
<p>Une dépendance est donc toute classe externe utilisée pour créer une instance à l&#x27;intérieur de la classe active.</p>
<p>Le mécanisme d&#x27;injection de dépendances permet de briser cette relation directe de A vers B. Au lieu d&#x27;avoir une relation directe, on aura une relation indirecte permettant d&#x27;utiliser n&#x27;importe quelle classe qui répondra à la définition (l&#x27;interface) de B. Il sera donc possible d&#x27;utiliser autre chose que B avec A.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pourquoi-opter-pour-linjection-de-dépendances-">Pourquoi opter pour l’injection de dépendances ?<a href="#pourquoi-opter-pour-linjection-de-dépendances-" class="hash-link" aria-label="Direct link to Pourquoi opter pour l’injection de dépendances ?" title="Direct link to Pourquoi opter pour l’injection de dépendances ?">​</a></h2>
<p>Il y a deux raisons principales : l’utilisation d’abstractions et les tests unitaires.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="les-abstractions">Les abstractions<a href="#les-abstractions" class="hash-link" aria-label="Direct link to Les abstractions" title="Direct link to Les abstractions">​</a></h3>
<p>L’abstraction est un des principes fondamentaux de la programmation orientée objet. En suivant ce processus d’abstraction, le développeur masque toutes les informations non pertinentes d’un objet à des fins de simplification et d’efficacité.</p>
<p>Les abstractions sont généralement implémentées en tant que classes ou interfaces abstraites et permettent d’introduire la notion de contrat, dans la syntaxe C# ce sont les interfaces. Ce sont elles qui vont permettre la mise en œuvre du principe d&#x27;injection de dépendances.</p>
<p>Lorsque les modules de bas niveau implémentent des interfaces et que ce sont ces interfaces qui sont injectées dans les modules de haut niveau, on ne dépend plus des implémentations (des « détails ») et on peut dès lors « remplacer » une implémentation par une autre tant que la nouvelle implémentation respecte l’abstraction (c’est-à-dire qu’elle implémente l’interface).</p>
<p>On voit que grâce aux abstractions nous avons introduit un découplage des modules (on peut aussi parler de « couplage faible ») et que grâce à cela la modification ou le remplacement d’un module de bas niveau n’a pas d’impact sur les modules qui en dépendent (du moins tant que l’abstraction, le contrat, ne change pas).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="les-tests-unitaires">Les tests unitaires<a href="#les-tests-unitaires" class="hash-link" aria-label="Direct link to Les tests unitaires" title="Direct link to Les tests unitaires">​</a></h3>
<p>Le deuxième bénéfice principal de l’injection de dépendances réside dans la facilité de rédiger des tests unitaires.</p>
<p>Les tests unitaires sont menés par le développeur lui-même, et consistent à vérifier la bonne exécution des fonctions dont il a la charge. Ces fonctions sont testées de manière indépendante, souvent avec des données réduites. Il est souhaitable de définir très tôt des jeux de tests représentatifs, car le développeur pourra réaliser les tests unitaires sur cette base et la qualité en sera améliorée.</p>
<p>L’objectif d’un test unitaire est donc de tester une « unité de code » dans une situation donnée. Un test unitaire n’a surtout pas pour vocation de tester toute une chaine d’implémentations et notamment les différentes implémentations des dépendances de la classe testée.</p>
<p>En l’absence d’un mécanisme d’injection de dépendances, une des principales difficultés pour écrire des tests unitaires corrects va être de s’affranchir des dépendances de la classe puisqu’elle les instancie elle-même.</p>
<p><a href="https://www.softfluent.fr/blog/injection-de-dependances-a-quoi-ca-sert/#:~:text=L&#x27;injection%20de%20d%C3%A9pendances%20consiste,injecter%20dans%20la%20classe%20correspondante." target="_blank" rel="noopener noreferrer">source</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="théorie-interfaces">Théorie: interfaces<a href="#théorie-interfaces" class="hash-link" aria-label="Direct link to Théorie: interfaces" title="Direct link to Théorie: interfaces">​</a></h2>
<p>Les interfaces sont utilisées afin de déconnecter encore plus l&#x27;application des classes qui réaliseront les opérations demandées. Une interface définie une suite d&#x27;opérations que devront implanter les classes qui respectent cette interface. De cette façon, il est possible de remplacer une classe par une autre, tant qu&#x27;elle respecte l&#x27;interface. Une interface est, en quelque sorte, un contrat. Les classes indiquent qu&#x27;elles implémentent toutes les fonctionnalités définies dans l&#x27;interface. Si une classe A utilisant une classe B respectant une interface C, alors A est assurée que toutes les fonctionnalités de C sont implantées dans B. En quelques sortes, une interface définie le <strong>quoi</strong>, alors que la classe qui l&#x27;implémente va définir le <strong>comment</strong>.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Il est possible de générer automatiquement l&#x27;interface à partir d&#x27;une classe avec une action rapide dans Visual Studio. Placez le curseur sur le nom de la classe, faites <strong>CTRL+.</strong> (CTRL et le point) et sélectionnez <strong>Extraire l&#x27;interface</strong>. (ou <strong>CTRL+R, CTRL+I</strong>, ou Edition/Refactoriser/Extraire interface)</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>En <strong>c#</strong>, si un membre provient de l&#x27;interface, il faut seulement le documenter dans l&#x27;interface pour respecter le principe <strong>DRY (Don&#x27;t Repeate Yourself) ou Ne te répète pas.</strong></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comment-sera-utilisée-linjection-de-dépendance-dans-ce-projet">Comment sera utilisée l&#x27;injection de dépendance dans ce projet<a href="#comment-sera-utilisée-linjection-de-dépendance-dans-ce-projet" class="hash-link" aria-label="Direct link to Comment sera utilisée l&#x27;injection de dépendance dans ce projet" title="Direct link to Comment sera utilisée l&#x27;injection de dépendance dans ce projet">​</a></h2>
<p>Il existe plusieurs façons d&#x27;intégrer l&#x27;injection de dépendance</p>
<p>Nous utiliserons un hôte générique .NET (<a href="https://learn.microsoft.com/fr-fr/dotnet/core/extensions/generic-host?tabs=hostbuilder" target="_blank" rel="noopener noreferrer">pour plus d&#x27;info</a>)</p>
<p>Plus précisément, nous utiliserons un <strong>IHostBuilder</strong>.</p>
<p>Voici un extrait de la section <strong>Paramètres du générateur d&#x27;hôte</strong> de cette page. Nous verrons plus en détails les éléments en gras:</p>
<hr>
<ul>
<li>
<p>La méthode <strong>CreateDefaultBuilder</strong> :</p>
<ul>
<li>Définit le chemin retourné par GetCurrentDirectory() comme racine de contenu.</li>
<li>Charge la configuration de l’hôte à partir de :<!-- -->
<ul>
<li>Variables d’environnement comportant le préfixe DOTNET_.</li>
<li>Arguments de ligne de commande</li>
</ul>
</li>
<li>Charge la configuration de l’application à partir de :<!-- -->
<ul>
<li><strong>appsettings.json</strong></li>
<li>appsettings.{Environment}.json</li>
<li>Secret Manager quand l’application s’exécute dans l’environnement Development.</li>
<li>Variables d&#x27;environnement.</li>
<li>Arguments de ligne de commande</li>
</ul>
</li>
<li>Ajoute les fournisseurs de journalisation suivants :<!-- -->
<ul>
<li>Console</li>
<li>Déboguer</li>
<li>EventSource</li>
<li>EventLog (uniquement en cas d’exécution sur Windows)</li>
</ul>
</li>
<li>Active la validation de l’étendue et la validation de dépendances lorsque l’environnement est Development.</li>
</ul>
</li>
<li>
<p>Utilisez la méthode <strong>ConfigureServices</strong> pour ajouter des services à l’instance <strong>Microsoft.Extensions.DependencyInjection.IServiceCollection</strong>. Ces services permettent de créer un <strong>IServiceProvider</strong> utilisé avec l’injection de dépendances pour résoudre les services inscrits.</p>
</li>
</ul>
<hr>
<p>Afin de faire l&#x27;injection, nous allons enregistrer une interfaces (<strong>I</strong>) et lui associer une classe (<strong>C</strong>) à injecter. Dans le code, si une fonction requiert un objet du type <strong>I</strong>, alors un objet de la classe <strong>C</strong> sera fourni. Le new est fait par le système d&#x27;injection, il n&#x27;est donc pas visible dans le code de l&#x27;application.</p>
<p>Par exemple, nous allons enregistrer des Services via leur interface:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Ne pas copier</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">services</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-method function" style="color:#d73a49">AddScoped</span><span class="token generic-method generic class-name punctuation" style="color:#393A34">&lt;</span><span class="token generic-method generic class-name">ICategorieService</span><span class="token generic-method generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-method generic class-name"> CategorieService</span><span class="token generic-method generic class-name punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Plus tard, nous définirons une classe pour gérer les catégories. Le constructeur de cette classe indiquera qu&#x27;il a besoin de qqchose qui répond à l&#x27;interface ICategorieService</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Ne pas copier</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GestionCategorieVM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ICategorieService</span><span class="token plain"> categorieService</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Le système va générer une nouvelle instance (si nécessaire) de la classe qui est présentement associée à <strong>ICategorieService</strong>, c&#x27;est à dire: <strong>CategorieService</strong>.</p>
<p>Il est donc très facile de changer la classe associée à ICategorieService. Il suffit de changer la ligne d&#x27;association, et tout le code utilisera maintenant une nouvelle classe. (nous verrons que cette technique est utilisée pour faire des tests unitaires)</p>
<p>Dans la section suivante, nous allons mettre en place plusieurs interfaces/classes qui seront par la suite utilisées dans la section WPF. L&#x27;injection de dépendances ne sera donc pas directement utilisée dans la partie Core. Elle sera réellement utilisée dans la partie WPF du projet. Mais il faut mettre les choses en place.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="type-denregistrement-des-dépendances">Type d&#x27;enregistrement des dépendances<a href="#type-denregistrement-des-dépendances" class="hash-link" aria-label="Direct link to Type d&#x27;enregistrement des dépendances" title="Direct link to Type d&#x27;enregistrement des dépendances">​</a></h2>
<p>Il existe 3 types d&#x27;enregistrement pour les dépendances. Ces types d&#x27;enregistrement consistent à la durée de vie de l&#x27;instance de la classe qui sera créée lors de l&#x27;injection.</p>
<ul>
<li>
<p><strong>Transient</strong></p>
<p>Une nouvelle instance est créée à chaque fois qu&#x27;un objet demande une injection de cette dépendance.</p>
</li>
<li>
<p><strong>Scoped</strong></p>
<p>Une seule instance est créée pour toute la durée de vie du <strong>scope</strong>. Tous les objets qui demandent une injection de ce service à l&#x27;intérieur du <strong>scope</strong> auront la même instance.</p>
<p>En application console, le <strong>scope</strong> doit être créé manuellement.</p>
<p>Par contre, dans le cas d&#x27;une application <strong>Blazor Server</strong>, un rafraichissement du navigateur ou un nouvel onglet consiste à un nouveau <strong>scope</strong>. Le changement de page sans rafraichissement du navigateur n&#x27;occasionne pas de changement de <strong>scope</strong>. Le <strong>scope</strong> consiste à la création de la requête initiale avec le serveur par le navigateur.</p>
</li>
<li>
<p><strong>Singleton</strong></p>
<p>Une seule instance est créée pour toute la durée de vie de l&#x27;application.</p>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/4N1_2024/docs/WPF partie 1/supercarte_ef"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SuperCarte.EF</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4N1_2024/docs/WPF partie 1/supercarte_core"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SuperCarte.Core</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#définition" class="table-of-contents__link toc-highlight">Définition</a></li><li><a href="#quest-ce-quune-dépendance-" class="table-of-contents__link toc-highlight">Qu&#39;est-ce qu&#39;une dépendance ?</a></li><li><a href="#pourquoi-opter-pour-linjection-de-dépendances-" class="table-of-contents__link toc-highlight">Pourquoi opter pour l’injection de dépendances ?</a><ul><li><a href="#les-abstractions" class="table-of-contents__link toc-highlight">Les abstractions</a></li><li><a href="#les-tests-unitaires" class="table-of-contents__link toc-highlight">Les tests unitaires</a></li></ul></li><li><a href="#théorie-interfaces" class="table-of-contents__link toc-highlight">Théorie: interfaces</a></li><li><a href="#comment-sera-utilisée-linjection-de-d épendance-dans-ce-projet" class="table-of-contents__link toc-highlight">Comment sera utilisée l&#39;injection de dépendance dans ce projet</a></li><li><a href="#type-denregistrement-des-dépendances" class="table-of-contents__link toc-highlight">Type d&#39;enregistrement des dépendances</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>